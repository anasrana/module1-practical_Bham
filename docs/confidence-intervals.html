<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Confidence Intervals | Essentials of Mathematics and Statistics</title>
  <meta name="description" content="This contains practicals for Module 1 (Essentials of Mathematics and Statistics)." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Confidence Intervals | Essentials of Mathematics and Statistics" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://anasrana.github.io/module1-practical_Bham/" />
  
  <meta property="og:description" content="This contains practicals for Module 1 (Essentials of Mathematics and Statistics)." />
  <meta name="github-repo" content="anasrana/module1-practical_Bham" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Confidence Intervals | Essentials of Mathematics and Statistics" />
  
  <meta name="twitter:description" content="This contains practicals for Module 1 (Essentials of Mathematics and Statistics)." />
  

<meta name="author" content="Anas A Rana" />


<meta name="date" content="2021-10-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="model-answers-mle.html"/>
<link rel="next" href="model-answer-confidence-interval.html"/>
<script src="assets/header-attrs-2.11/header-attrs.js"></script>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Essentials of Mathematics and Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#how-to-use-these-resources"><i class="fa fa-check"></i><b>1.1</b> How to use these resources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started-in-r-and-rstudio.html"><a href="getting-started-in-r-and-rstudio.html"><i class="fa fa-check"></i><b>2</b> Getting started in R and Rstudio</a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started-in-r-and-rstudio.html"><a href="getting-started-in-r-and-rstudio.html#r-scripts"><i class="fa fa-check"></i><b>2.1</b> R scripts</a></li>
<li class="chapter" data-level="2.2" data-path="getting-started-in-r-and-rstudio.html"><a href="getting-started-in-r-and-rstudio.html#creating-an-r-script"><i class="fa fa-check"></i><b>2.2</b> Creating an R script</a></li>
<li class="chapter" data-level="2.3" data-path="getting-started-in-r-and-rstudio.html"><a href="getting-started-in-r-and-rstudio.html#saving-an-r-script"><i class="fa fa-check"></i><b>2.3</b> Saving an R script</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started-in-r-and-rstudio.html"><a href="getting-started-in-r-and-rstudio.html#executing-code-in-an-r-script"><i class="fa fa-check"></i><b>2.4</b> Executing code in an R script</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="getting-started-in-r-and-rstudio.html"><a href="getting-started-in-r-and-rstudio.html#comments-in-an-r-script-documenting-your-code"><i class="fa fa-check"></i><b>2.4.1</b> Comments in an R script (documenting your code)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-sets.html"><a href="data-sets.html"><i class="fa fa-check"></i><b>3</b> Data sets</a></li>
<li class="chapter" data-level="4" data-path="simulating-random-numbers.html"><a href="simulating-random-numbers.html"><i class="fa fa-check"></i><b>4</b> Simulating random numbers</a></li>
<li class="chapter" data-level="5" data-path="markov-chains.html"><a href="markov-chains.html"><i class="fa fa-check"></i><b>5</b> Markov Chains</a></li>
<li class="chapter" data-level="" data-path="model-answers-3-state-markov-chain.html"><a href="model-answers-3-state-markov-chain.html"><i class="fa fa-check"></i>Model answers 3 state Markov Chain</a></li>
<li class="chapter" data-level="6" data-path="a-monopoly-simulation.html"><a href="a-monopoly-simulation.html"><i class="fa fa-check"></i><b>6</b> A Monopoly simulation</a>
<ul>
<li class="chapter" data-level="6.1" data-path="a-monopoly-simulation.html"><a href="a-monopoly-simulation.html#moving-around-the-board"><i class="fa fa-check"></i><b>6.1</b> Moving around the board</a></li>
<li class="chapter" data-level="6.2" data-path="a-monopoly-simulation.html"><a href="a-monopoly-simulation.html#going-to-jail"><i class="fa fa-check"></i><b>6.2</b> Going to Jail</a></li>
<li class="chapter" data-level="6.3" data-path="a-monopoly-simulation.html"><a href="a-monopoly-simulation.html#further-exercises"><i class="fa fa-check"></i><b>6.3</b> Further Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html"><i class="fa fa-check"></i><b>7</b> Monte Carlo Methods</a>
<ul>
<li class="chapter" data-level="7.1" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#integration"><i class="fa fa-check"></i><b>7.1</b> Integration</a></li>
<li class="chapter" data-level="7.2" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#problem-mc-accuracy"><i class="fa fa-check"></i><b>7.2</b> Problem: MC accuracy</a></li>
<li class="chapter" data-level="7.3" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#approximating-the-binomial-distribution"><i class="fa fa-check"></i><b>7.3</b> Approximating the Binomial Distribution</a></li>
<li class="chapter" data-level="7.4" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#problem-mc-binomial"><i class="fa fa-check"></i><b>7.4</b> Problem: MC Binomial</a></li>
<li class="chapter" data-level="7.5" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#monte-carlo-expectations"><i class="fa fa-check"></i><b>7.5</b> Monte Carlo Expectations</a></li>
<li class="chapter" data-level="7.6" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#using-functions"><i class="fa fa-check"></i><b>7.6</b> Using Functions</a></li>
<li class="chapter" data-level="7.7" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#simulating-from-function"><i class="fa fa-check"></i><b>7.7</b> Simulating from function</a></li>
<li class="chapter" data-level="7.8" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#problem-mc-expectation"><i class="fa fa-check"></i><b>7.8</b> Problem: MC Expectation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-answers-monte-carlo.html"><a href="model-answers-monte-carlo.html"><i class="fa fa-check"></i>Model Answers: Monte Carlo</a>
<ul>
<li class="chapter" data-level="7.9" data-path="model-answers-monte-carlo.html"><a href="model-answers-monte-carlo.html#problem-mc-accuracy-1"><i class="fa fa-check"></i><b>7.9</b> Problem: MC accuracy</a></li>
<li class="chapter" data-level="7.10" data-path="model-answers-monte-carlo.html"><a href="model-answers-monte-carlo.html#problem-mc-expectation-1"><i class="fa fa-check"></i><b>7.10</b> Problem: MC Expectation</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="model-answers-monte-carlo.html"><a href="model-answers-monte-carlo.html#problem-1"><i class="fa fa-check"></i><b>7.10.1</b> Problem 1</a></li>
<li class="chapter" data-level="7.10.2" data-path="model-answers-monte-carlo.html"><a href="model-answers-monte-carlo.html#problem-2"><i class="fa fa-check"></i><b>7.10.2</b> Problem 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html"><i class="fa fa-check"></i><b>8</b> Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="8.1" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#the-likelihood-function"><i class="fa fa-check"></i><b>8.1</b> The likelihood function</a></li>
<li class="chapter" data-level="8.2" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#optimisation"><i class="fa fa-check"></i><b>8.2</b> Optimisation</a></li>
<li class="chapter" data-level="8.3" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#two-parameter-estimation"><i class="fa fa-check"></i><b>8.3</b> Two-parameter estimation</a></li>
<li class="chapter" data-level="8.4" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#problem-mle"><i class="fa fa-check"></i><b>8.4</b> Problem: MLE</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-answers-mle.html"><a href="model-answers-mle.html"><i class="fa fa-check"></i>Model Answers: MLE</a></li>
<li class="chapter" data-level="9" data-path="confidence-intervals.html"><a href="confidence-intervals.html"><i class="fa fa-check"></i><b>9</b> Confidence Intervals</a>
<ul>
<li class="chapter" data-level="9.1" data-path="confidence-intervals.html"><a href="confidence-intervals.html#setup"><i class="fa fa-check"></i><b>9.1</b> Setup</a></li>
<li class="chapter" data-level="9.2" data-path="confidence-intervals.html"><a href="confidence-intervals.html#simulating-data"><i class="fa fa-check"></i><b>9.2</b> Simulating data</a></li>
<li class="chapter" data-level="9.3" data-path="confidence-intervals.html"><a href="confidence-intervals.html#constructing-the-confidence-interval"><i class="fa fa-check"></i><b>9.3</b> Constructing the confidence interval</a></li>
<li class="chapter" data-level="9.4" data-path="confidence-intervals.html"><a href="confidence-intervals.html#experiment"><i class="fa fa-check"></i><b>9.4</b> Experiment</a></li>
<li class="chapter" data-level="9.5" data-path="confidence-intervals.html"><a href="confidence-intervals.html#problem-confidence-interval"><i class="fa fa-check"></i><b>9.5</b> Problem: Confidence Interval</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-answer-confidence-interval.html"><a href="model-answer-confidence-interval.html"><i class="fa fa-check"></i>Model Answer: Confidence Interval</a></li>
<li class="chapter" data-level="10" data-path="computational-testing-techniques.html"><a href="computational-testing-techniques.html"><i class="fa fa-check"></i><b>10</b> Computational Testing Techniques</a>
<ul>
<li class="chapter" data-level="10.1" data-path="computational-testing-techniques.html"><a href="computational-testing-techniques.html#problem-1-1"><i class="fa fa-check"></i><b>10.1</b> Problem 1</a></li>
<li class="chapter" data-level="10.2" data-path="computational-testing-techniques.html"><a href="computational-testing-techniques.html#problem-2-1"><i class="fa fa-check"></i><b>10.2</b> Problem 2</a></li>
<li class="chapter" data-level="10.3" data-path="computational-testing-techniques.html"><a href="computational-testing-techniques.html#problem-3"><i class="fa fa-check"></i><b>10.3</b> Problem 3</a></li>
<li class="chapter" data-level="10.4" data-path="computational-testing-techniques.html"><a href="computational-testing-techniques.html#problem-4"><i class="fa fa-check"></i><b>10.4</b> Problem 4</a></li>
<li class="chapter" data-level="10.5" data-path="computational-testing-techniques.html"><a href="computational-testing-techniques.html#problem-5"><i class="fa fa-check"></i><b>10.5</b> Problem 5</a></li>
<li class="chapter" data-level="10.6" data-path="computational-testing-techniques.html"><a href="computational-testing-techniques.html#problem-7"><i class="fa fa-check"></i><b>10.6</b> Problem 7</a></li>
<li class="chapter" data-level="10.7" data-path="computational-testing-techniques.html"><a href="computational-testing-techniques.html#problem-8"><i class="fa fa-check"></i><b>10.7</b> Problem 8</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-answers-computational-testing.html"><a href="model-answers-computational-testing.html"><i class="fa fa-check"></i>Model Answers: Computational Testing</a>
<ul>
<li class="chapter" data-level="10.8" data-path="model-answers-computational-testing.html"><a href="model-answers-computational-testing.html#problem-1-2"><i class="fa fa-check"></i><b>10.8</b> Problem 1</a></li>
<li class="chapter" data-level="10.9" data-path="model-answers-computational-testing.html"><a href="model-answers-computational-testing.html#problem-2-2"><i class="fa fa-check"></i><b>10.9</b> Problem 2</a></li>
<li class="chapter" data-level="10.10" data-path="model-answers-computational-testing.html"><a href="model-answers-computational-testing.html#problem-3-1"><i class="fa fa-check"></i><b>10.10</b> Problem 3</a></li>
<li class="chapter" data-level="10.11" data-path="model-answers-computational-testing.html"><a href="model-answers-computational-testing.html#problem-4-1"><i class="fa fa-check"></i><b>10.11</b> Problem 4</a></li>
<li class="chapter" data-level="10.12" data-path="model-answers-computational-testing.html"><a href="model-answers-computational-testing.html#problem-5-1"><i class="fa fa-check"></i><b>10.12</b> Problem 5</a></li>
<li class="chapter" data-level="10.13" data-path="model-answers-computational-testing.html"><a href="model-answers-computational-testing.html#problem-6"><i class="fa fa-check"></i><b>10.13</b> Problem 6</a></li>
<li class="chapter" data-level="10.14" data-path="model-answers-computational-testing.html"><a href="model-answers-computational-testing.html#problem-7-1"><i class="fa fa-check"></i><b>10.14</b> Problem 7</a></li>
<li class="chapter" data-level="10.15" data-path="model-answers-computational-testing.html"><a href="model-answers-computational-testing.html#problem-8-1"><i class="fa fa-check"></i><b>10.15</b> Problem 8</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html"><i class="fa fa-check"></i><b>11</b> Practical: Linear regression</a>
<ul>
<li class="chapter" data-level="11.1" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#data"><i class="fa fa-check"></i><b>11.1</b> Data</a></li>
<li class="chapter" data-level="11.2" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#simulating-data-1"><i class="fa fa-check"></i><b>11.2</b> Simulating data</a></li>
<li class="chapter" data-level="11.3" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#fitting-simple-linear-regression-model"><i class="fa fa-check"></i><b>11.3</b> Fitting simple linear regression model</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#least-squared-estimation"><i class="fa fa-check"></i><b>11.3.1</b> Least squared estimation</a></li>
<li class="chapter" data-level="11.3.2" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#maximum-likelihood-estimation"><i class="fa fa-check"></i><b>11.3.2</b> Maximum likelihood estimation</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#effect-of-variance"><i class="fa fa-check"></i><b>11.4</b> Effect of variance</a></li>
<li class="chapter" data-level="11.5" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#exercise"><i class="fa fa-check"></i><b>11.5</b> Exercise</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#part-i"><i class="fa fa-check"></i><b>11.5.1</b> Part I</a></li>
<li class="chapter" data-level="11.5.2" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#part-ii"><i class="fa fa-check"></i><b>11.5.2</b> Part II</a></li>
<li class="chapter" data-level="11.5.3" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#part-iii"><i class="fa fa-check"></i><b>11.5.3</b> Part III</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-answers-linear-regression.html"><a href="model-answers-linear-regression.html"><i class="fa fa-check"></i>Model answers: Linear regression</a>
<ul>
<li class="chapter" data-level="11.6" data-path="model-answers-linear-regression.html"><a href="model-answers-linear-regression.html#exercise-i"><i class="fa fa-check"></i><b>11.6</b> Exercise I</a></li>
<li class="chapter" data-level="11.7" data-path="model-answers-linear-regression.html"><a href="model-answers-linear-regression.html#exercise-ii"><i class="fa fa-check"></i><b>11.7</b> Exercise II</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="model-answers-linear-regression.html"><a href="model-answers-linear-regression.html#comparison-of-data"><i class="fa fa-check"></i><b>11.7.1</b> Comparison of data</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="model-answers-linear-regression.html"><a href="model-answers-linear-regression.html#exercise-ii-1"><i class="fa fa-check"></i><b>11.8</b> Exercise II</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="practical-principal-component-analysis.html"><a href="practical-principal-component-analysis.html"><i class="fa fa-check"></i><b>12</b> Practical: Principal component analysis</a>
<ul>
<li class="chapter" data-level="12.1" data-path="practical-principal-component-analysis.html"><a href="practical-principal-component-analysis.html#data-1"><i class="fa fa-check"></i><b>12.1</b> Data</a></li>
<li class="chapter" data-level="12.2" data-path="practical-principal-component-analysis.html"><a href="practical-principal-component-analysis.html#introduction-1"><i class="fa fa-check"></i><b>12.2</b> Introduction</a></li>
<li class="chapter" data-level="12.3" data-path="practical-principal-component-analysis.html"><a href="practical-principal-component-analysis.html#exercise-i-1"><i class="fa fa-check"></i><b>12.3</b> Exercise I</a></li>
<li class="chapter" data-level="12.4" data-path="practical-principal-component-analysis.html"><a href="practical-principal-component-analysis.html#exercise-ii-2"><i class="fa fa-check"></i><b>12.4</b> Exercise II</a></li>
<li class="chapter" data-level="12.5" data-path="practical-principal-component-analysis.html"><a href="practical-principal-component-analysis.html#exercise-iii"><i class="fa fa-check"></i><b>12.5</b> Exercise III</a></li>
<li class="chapter" data-level="12.6" data-path="practical-principal-component-analysis.html"><a href="practical-principal-component-analysis.html#exercise-iv-single-cell-data"><i class="fa fa-check"></i><b>12.6</b> Exercise IV: Single cell data</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="practical-multiple-regression.html"><a href="practical-multiple-regression.html"><i class="fa fa-check"></i><b>13</b> Practical: Multiple regression</a>
<ul>
<li class="chapter" data-level="13.1" data-path="practical-multiple-regression.html"><a href="practical-multiple-regression.html#multiple-regression"><i class="fa fa-check"></i><b>13.1</b> Multiple regression</a></li>
<li class="chapter" data-level="13.2" data-path="practical-multiple-regression.html"><a href="practical-multiple-regression.html#categorical-covariates"><i class="fa fa-check"></i><b>13.2</b> Categorical covariates</a></li>
<li class="chapter" data-level="13.3" data-path="practical-multiple-regression.html"><a href="practical-multiple-regression.html#residuals"><i class="fa fa-check"></i><b>13.3</b> Residuals</a></li>
<li class="chapter" data-level="13.4" data-path="practical-multiple-regression.html"><a href="practical-multiple-regression.html#gradient-descent-algorithm"><i class="fa fa-check"></i><b>13.4</b> Gradient descent algorithm (+)</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html"><i class="fa fa-check"></i><b>14</b> Practical: Generalised linear models</a>
<ul>
<li class="chapter" data-level="14.1" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#data-2"><i class="fa fa-check"></i><b>14.1</b> Data</a></li>
<li class="chapter" data-level="14.2" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#detecting-snp-associations"><i class="fa fa-check"></i><b>14.2</b> Detecting SNP associations</a></li>
<li class="chapter" data-level="14.3" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#gwas-and-logistic-regression"><i class="fa fa-check"></i><b>14.3</b> GWAS and logistic regression</a></li>
<li class="chapter" data-level="14.4" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#negative-binomial-and-poisson-regression"><i class="fa fa-check"></i><b>14.4</b> Negative binomial and Poisson regression</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#count-based-glms"><i class="fa fa-check"></i><b>14.4.1</b> Count-based GLMs</a></li>
<li class="chapter" data-level="14.4.2" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#fitting-a-glm"><i class="fa fa-check"></i><b>14.4.2</b> Fitting a GLM</a></li>
<li class="chapter" data-level="14.4.3" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#comparing-nested-models"><i class="fa fa-check"></i><b>14.4.3</b> Comparing nested models</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#negative-binomial-vs-poisson-glms"><i class="fa fa-check"></i><b>14.5</b> Negative-Binomial vs Poisson GLMs</a></li>
<li class="chapter" data-level="14.6" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#further-understanding-the-model-optional"><i class="fa fa-check"></i><b>14.6</b> Further understanding the model (<strong>OPTIONAL</strong>)</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Essentials of Mathematics and Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="confidence-intervals" class="section level1" number="9">
<h1><span class="header-section-number">9</span> Confidence Intervals</h1>
<p>In this practical, you will learn how to derive confidence intervals for a particular problem using Monte Carlo simulations.</p>
<p>In a random experiment, a sample of data is collected from which we can estimate a population parameter of interest. This estimate can either be a point estimate or an <em>interval estimate</em> - a range of values.</p>
<p>A <strong>confidence interval</strong> is an interval estimate which has an associated <em>confidence level</em>. The confidence level tells us the probability that the <em>procedure</em> that is used to construct the confidence interval will result in the interval containing the true population parameter. It is <em>not</em> the probability that the population parameter lies in the range.</p>
<p>This is a very counter-intuitive concept which we shall now illustrate in this exercise.</p>
<div id="setup" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Setup</h2>
<p>First, create a new <code>R</code> script within Rstudio then we will start with some code preamble. We will use the package <code>ggplot2</code> for plotting.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="confidence-intervals.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<p>Use <code>install.packages("ggplot2")</code> in the console window if the package is not installed on your system.</p>
<p>Lets define the width of an interval, we will set this to 1 initially but we will change this later on:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="confidence-intervals.html#cb82-1" aria-hidden="true" tabindex="-1"></a>interval_width <span class="ot">=</span> <span class="dv">1</span> <span class="co"># width of confidence interval</span></span></code></pre></div>
</div>
<div id="simulating-data" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Simulating data</h2>
<p>We are now going to generate some simulated data for our experiment. We will create 30 samples from a Normal distribution with mean 2.5 and variance 1. These are <em>true</em> values of the population parameters. In a real experiment, we would not know these values but using simulated data, we obviously control these.</p>
<p>Let define these first:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="confidence-intervals.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of data points to generate</span></span>
<span id="cb83-2"><a href="confidence-intervals.html#cb83-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb83-3"><a href="confidence-intervals.html#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="co"># population mean</span></span>
<span id="cb83-4"><a href="confidence-intervals.html#cb83-4" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fl">2.5</span></span>
<span id="cb83-5"><a href="confidence-intervals.html#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="co"># population standard deviation (square root of population variance)</span></span>
<span id="cb83-6"><a href="confidence-intervals.html#cb83-6" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">1.0</span></span></code></pre></div>
<p>Now, we generate some normally distributed data using the <code>R</code> function <code>rnorm</code>,</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="confidence-intervals.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate n values from the  Normal distribution N(mu, sigma)</span></span>
<span id="cb84-2"><a href="confidence-intervals.html#cb84-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)</span></code></pre></div>
<p>We now have 30 samples from a Normal distribution with population mean 2.5 and variance 1.</p>
</div>
<div id="constructing-the-confidence-interval" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Constructing the confidence interval</h2>
<p>We are going to pretend that we do not know the population mean value (2.5) used to generate this dataset and try to provide an interval estimate for it from the simulated sample data.</p>
<p>Remember, from lectures, that the sample mean <span class="math inline">\(\bar{x}\)</span> is a natural point estimate for the population mean <span class="math inline">\(\mu\)</span>.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="confidence-intervals.html#cb85-1" aria-hidden="true" tabindex="-1"></a>x_bar <span class="ot">=</span> <span class="fu">mean</span>(x) <span class="co"># compute sample mean</span></span></code></pre></div>
<p>so a suitable interval might be centred on the sample mean and extend out,</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="confidence-intervals.html#cb86-1" aria-hidden="true" tabindex="-1"></a>interval <span class="ot">&lt;-</span> <span class="fu">c</span>(x_bar <span class="sc">-</span> interval_width <span class="sc">/</span> <span class="dv">2</span>, x_bar <span class="sc">+</span> interval_width <span class="sc">/</span> <span class="dv">2</span>)</span></code></pre></div>
<p>Let’s look at this interval:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="confidence-intervals.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(interval)</span></code></pre></div>
<pre><code>## [1] 1.959777 2.959777</code></pre>
<blockquote>
<p><strong>Q: Does the confidence interval contain the true parameter?</strong></p>
</blockquote>
</div>
<div id="experiment" class="section level2" number="9.4">
<h2><span class="header-section-number">9.4</span> Experiment</h2>
<p>The previous experiment only examined one simulated dataset so we cannot fully understand the probabilistic interpretation of the confidence interval just yet. At the moment, the interval you have calculated will either contain the population mean or not.</p>
<p>In order to understand the probabilistic interpretation, we will need to generate many data sets, construct confidence intervals as we have for each and then see across all generated data sets, how often those intervals cover the true population mean.</p>
<p>For a Monte Carlo simulation, we will need many repeats of the simulation. Lets define the number of repeats to be used:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="confidence-intervals.html#cb89-1" aria-hidden="true" tabindex="-1"></a>nreps <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># number of Monte Carlo simulation runs</span></span></code></pre></div>
<p>We will use 1000 simulations initially to make the code quick to run but you may want to make this higher later on for greater accuracy.</p>
<p>Now, let us define a series of interval widths to simultaneously test,</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="confidence-intervals.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define a series of interval widths</span></span>
<span id="cb90-2"><a href="confidence-intervals.html#cb90-2" aria-hidden="true" tabindex="-1"></a>interval_width <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">1.0</span>, <span class="fl">0.1</span>)</span>
<span id="cb90-3"><a href="confidence-intervals.html#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="co"># store the number of interval widths generated</span></span>
<span id="cb90-4"><a href="confidence-intervals.html#cb90-4" aria-hidden="true" tabindex="-1"></a>n_interval_widths <span class="ot">&lt;-</span> <span class="fu">length</span>(interval_width)</span></code></pre></div>
<p>This creates a sequence of values from 0.1 to 1.0 in steps of 0.1 in the vector <code>interval_width</code>:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="confidence-intervals.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(interval_width)</span></code></pre></div>
<pre><code>##  [1] 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0</code></pre>
<p>Now, we will create a vector of zeros of the same length. We will use this to store the number of times that a confidence interval of those specific widths contain the true population mean</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="confidence-intervals.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a vector to store the number of times the population mean is contained</span></span>
<span id="cb93-2"><a href="confidence-intervals.html#cb93-2" aria-hidden="true" tabindex="-1"></a>mu_contained <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n_interval_widths)</span></code></pre></div>
<p>The hard work now begins. We use a <code>for</code> loop to repeat the simulation <code>nreps</code> times. Within each loop, we will simulate a new data set, compute a sample mean and then check if the confidence interval contains the true population mean. Since we are using more than one confidence width, we use a second <code>for</code> loop to cycle through the different widths.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="confidence-intervals.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (replicate <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nreps) {</span>
<span id="cb94-2"><a href="confidence-intervals.html#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="confidence-intervals.html#cb94-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">rnorm</span>(n) <span class="sc">+</span> mu <span class="co"># simulate a data set</span></span>
<span id="cb94-4"><a href="confidence-intervals.html#cb94-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-5"><a href="confidence-intervals.html#cb94-5" aria-hidden="true" tabindex="-1"></a>  xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(x) <span class="co"># compute the sample mean</span></span>
<span id="cb94-6"><a href="confidence-intervals.html#cb94-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-7"><a href="confidence-intervals.html#cb94-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># for each interval width that we are testing ...</span></span>
<span id="cb94-8"><a href="confidence-intervals.html#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_interval_widths) {</span>
<span id="cb94-9"><a href="confidence-intervals.html#cb94-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># check if the interval contains the true mean</span></span>
<span id="cb94-10"><a href="confidence-intervals.html#cb94-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ((mu <span class="sc">&gt;</span> xbar <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">*</span> interval_width[j]) <span class="sc">&amp;</span></span>
<span id="cb94-11"><a href="confidence-intervals.html#cb94-11" aria-hidden="true" tabindex="-1"></a>        (mu <span class="sc">&lt;</span> xbar <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> interval_width[j])) {</span>
<span id="cb94-12"><a href="confidence-intervals.html#cb94-12" aria-hidden="true" tabindex="-1"></a>      <span class="co"># if it is, we increment the count by one for this width</span></span>
<span id="cb94-13"><a href="confidence-intervals.html#cb94-13" aria-hidden="true" tabindex="-1"></a>      mu_contained[j] <span class="ot">&lt;-</span> mu_contained[j] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb94-14"><a href="confidence-intervals.html#cb94-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb94-15"><a href="confidence-intervals.html#cb94-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb94-16"><a href="confidence-intervals.html#cb94-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-17"><a href="confidence-intervals.html#cb94-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We can now calculate, for each width, an estimate of the probability that a confidence interval of that width will contain the population mean.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="confidence-intervals.html#cb95-1" aria-hidden="true" tabindex="-1"></a>probability_mean_contained <span class="ot">&lt;-</span> mu_contained <span class="sc">/</span> nreps</span></code></pre></div>
<p>Let’s use <code>ggplot2</code> to plot this relationship,</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="confidence-intervals.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a data frame containing the variables we wish to plot</span></span>
<span id="cb96-2"><a href="confidence-intervals.html#cb96-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">interval_width =</span> interval_width,</span>
<span id="cb96-3"><a href="confidence-intervals.html#cb96-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">probability_mean_contained =</span> probability_mean_contained)</span>
<span id="cb96-4"><a href="confidence-intervals.html#cb96-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-5"><a href="confidence-intervals.html#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="co"># initialise the ggplot</span></span>
<span id="cb96-6"><a href="confidence-intervals.html#cb96-6" aria-hidden="true" tabindex="-1"></a>plt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> interval_width, <span class="at">y =</span> probability_mean_contained))</span>
<span id="cb96-7"><a href="confidence-intervals.html#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create a line plot</span></span>
<span id="cb96-8"><a href="confidence-intervals.html#cb96-8" aria-hidden="true" tabindex="-1"></a>plt <span class="ot">&lt;-</span> plt <span class="sc">+</span> <span class="fu">geom_line</span>()</span>
<span id="cb96-9"><a href="confidence-intervals.html#cb96-9" aria-hidden="true" tabindex="-1"></a><span class="co"># add a horizontal axis label</span></span>
<span id="cb96-10"><a href="confidence-intervals.html#cb96-10" aria-hidden="true" tabindex="-1"></a>plt <span class="ot">&lt;-</span> plt <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Interval Width&quot;</span>)</span>
<span id="cb96-11"><a href="confidence-intervals.html#cb96-11" aria-hidden="true" tabindex="-1"></a><span class="co"># create a vertical axis label</span></span>
<span id="cb96-12"><a href="confidence-intervals.html#cb96-12" aria-hidden="true" tabindex="-1"></a>plt <span class="ot">&lt;-</span> plt <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Probability that mu is contained&quot;</span>)</span>
<span id="cb96-13"><a href="confidence-intervals.html#cb96-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-14"><a href="confidence-intervals.html#cb96-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plt) <span class="co"># plot to screen</span></span></code></pre></div>
<p><img src="Practicals-module_1_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
<p>Can you see that an interval width of <span class="math inline">\(0.6\times (\bar{x} \pm 0.3)\)</span> gives a confidence interval close to 90% probability of containing the population mean?</p>
<p>Remember from the lectures that we saw that the theory says <span class="math inline">\(\bar{x} \pm 1.65\,\frac{\sigma}{\sqrt{n}}\)</span> gives a 90% confidence interval?</p>
<p>So, if we compute <span class="math inline">\(2 \pm 1.65\, \frac{\sigma}{\sqrt{n}}\)</span>, what do we get?</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="confidence-intervals.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fl">1.65</span> <span class="sc">*</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n))</span></code></pre></div>
<pre><code>## [1] 0.6024948</code></pre>
<p>The Monte Carlo estimate matches up with the theory!</p>
</div>
<div id="problem-confidence-interval" class="section level2" number="9.5">
<h2><span class="header-section-number">9.5</span> Problem: Confidence Interval</h2>
<p>Can you devise a way to compute a confidence interval for the population variance?</p>
<p>You can make use of the following as a point estimate of the sample variance:</p>
<p><span class="math display">\[
  s^2 = \frac{1}{n - 1}\sum_{i = 1}^n (x - \bar{x})^2
\]</span></p>
<p>which can be calculated using the <code>sd</code> function in <code>R</code>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="model-answers-mle.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="model-answer-confidence-interval.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Practicals-module_1.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
