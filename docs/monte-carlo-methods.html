<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Monte Carlo Methods | Essentials of Mathematics and Statistics</title>
  <meta name="description" content="This contains practicals for Module 1 (Essentials of Mathematics and Statistics)." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Monte Carlo Methods | Essentials of Mathematics and Statistics" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://anasrana.github.io/module1-practical_Bham/" />
  
  <meta property="og:description" content="This contains practicals for Module 1 (Essentials of Mathematics and Statistics)." />
  <meta name="github-repo" content="anasrana/module1-practical_Bham" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Monte Carlo Methods | Essentials of Mathematics and Statistics" />
  
  <meta name="twitter:description" content="This contains practicals for Module 1 (Essentials of Mathematics and Statistics)." />
  

<meta name="author" content="Anas A Rana" />


<meta name="date" content="2021-10-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="a-monopoly-simulation.html"/>
<link rel="next" href="model-answers-monte-carlo.html"/>
<script src="assets/header-attrs-2.11/header-attrs.js"></script>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Essentials of Mathematics and Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#how-to-use-these-resources"><i class="fa fa-check"></i><b>1.1</b> How to use these resources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started-in-r-and-rstudio.html"><a href="getting-started-in-r-and-rstudio.html"><i class="fa fa-check"></i><b>2</b> Getting started in R and Rstudio</a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started-in-r-and-rstudio.html"><a href="getting-started-in-r-and-rstudio.html#r-scripts"><i class="fa fa-check"></i><b>2.1</b> R scripts</a></li>
<li class="chapter" data-level="2.2" data-path="getting-started-in-r-and-rstudio.html"><a href="getting-started-in-r-and-rstudio.html#creating-an-r-script"><i class="fa fa-check"></i><b>2.2</b> Creating an R script</a></li>
<li class="chapter" data-level="2.3" data-path="getting-started-in-r-and-rstudio.html"><a href="getting-started-in-r-and-rstudio.html#saving-an-r-script"><i class="fa fa-check"></i><b>2.3</b> Saving an R script</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started-in-r-and-rstudio.html"><a href="getting-started-in-r-and-rstudio.html#executing-code-in-an-r-script"><i class="fa fa-check"></i><b>2.4</b> Executing code in an R script</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="getting-started-in-r-and-rstudio.html"><a href="getting-started-in-r-and-rstudio.html#comments-in-an-r-script-documenting-your-code"><i class="fa fa-check"></i><b>2.4.1</b> Comments in an R script (documenting your code)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-sets.html"><a href="data-sets.html"><i class="fa fa-check"></i><b>3</b> Data sets</a></li>
<li class="chapter" data-level="4" data-path="simulating-random-numbers.html"><a href="simulating-random-numbers.html"><i class="fa fa-check"></i><b>4</b> Simulating random numbers</a></li>
<li class="chapter" data-level="5" data-path="markov-chains.html"><a href="markov-chains.html"><i class="fa fa-check"></i><b>5</b> Markov Chains</a></li>
<li class="chapter" data-level="" data-path="model-answers-3-state-markov-chain.html"><a href="model-answers-3-state-markov-chain.html"><i class="fa fa-check"></i>Model answers 3 state Markov Chain</a></li>
<li class="chapter" data-level="6" data-path="a-monopoly-simulation.html"><a href="a-monopoly-simulation.html"><i class="fa fa-check"></i><b>6</b> A Monopoly simulation</a>
<ul>
<li class="chapter" data-level="6.1" data-path="a-monopoly-simulation.html"><a href="a-monopoly-simulation.html#moving-around-the-board"><i class="fa fa-check"></i><b>6.1</b> Moving around the board</a></li>
<li class="chapter" data-level="6.2" data-path="a-monopoly-simulation.html"><a href="a-monopoly-simulation.html#going-to-jail"><i class="fa fa-check"></i><b>6.2</b> Going to Jail</a></li>
<li class="chapter" data-level="6.3" data-path="a-monopoly-simulation.html"><a href="a-monopoly-simulation.html#further-exercises"><i class="fa fa-check"></i><b>6.3</b> Further Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html"><i class="fa fa-check"></i><b>7</b> Monte Carlo Methods</a>
<ul>
<li class="chapter" data-level="7.1" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#integration"><i class="fa fa-check"></i><b>7.1</b> Integration</a></li>
<li class="chapter" data-level="7.2" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#problem-mc-accuracy"><i class="fa fa-check"></i><b>7.2</b> Problem: MC accuracy</a></li>
<li class="chapter" data-level="7.3" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#approximating-the-binomial-distribution"><i class="fa fa-check"></i><b>7.3</b> Approximating the Binomial Distribution</a></li>
<li class="chapter" data-level="7.4" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#problem-mc-binomial"><i class="fa fa-check"></i><b>7.4</b> Problem: MC Binomial</a></li>
<li class="chapter" data-level="7.5" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#monte-carlo-expectations"><i class="fa fa-check"></i><b>7.5</b> Monte Carlo Expectations</a></li>
<li class="chapter" data-level="7.6" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#using-functions"><i class="fa fa-check"></i><b>7.6</b> Using Functions</a></li>
<li class="chapter" data-level="7.7" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#simulating-from-function"><i class="fa fa-check"></i><b>7.7</b> Simulating from function</a></li>
<li class="chapter" data-level="7.8" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#problem-mc-expectation"><i class="fa fa-check"></i><b>7.8</b> Problem: MC Expectation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-answers-monte-carlo.html"><a href="model-answers-monte-carlo.html"><i class="fa fa-check"></i>Model Answers: Monte Carlo</a>
<ul>
<li class="chapter" data-level="7.9" data-path="model-answers-monte-carlo.html"><a href="model-answers-monte-carlo.html#problem-mc-accuracy-1"><i class="fa fa-check"></i><b>7.9</b> Problem: MC accuracy</a></li>
<li class="chapter" data-level="7.10" data-path="model-answers-monte-carlo.html"><a href="model-answers-monte-carlo.html#problem-mc-expectation-1"><i class="fa fa-check"></i><b>7.10</b> Problem: MC Expectation</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="model-answers-monte-carlo.html"><a href="model-answers-monte-carlo.html#problem-1"><i class="fa fa-check"></i><b>7.10.1</b> Problem 1</a></li>
<li class="chapter" data-level="7.10.2" data-path="model-answers-monte-carlo.html"><a href="model-answers-monte-carlo.html#problem-2"><i class="fa fa-check"></i><b>7.10.2</b> Problem 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html"><i class="fa fa-check"></i><b>8</b> Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="8.1" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#the-likelihood-function"><i class="fa fa-check"></i><b>8.1</b> The likelihood function</a></li>
<li class="chapter" data-level="8.2" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#optimisation"><i class="fa fa-check"></i><b>8.2</b> Optimisation</a></li>
<li class="chapter" data-level="8.3" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#two-parameter-estimation"><i class="fa fa-check"></i><b>8.3</b> Two-parameter estimation</a></li>
<li class="chapter" data-level="8.4" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#problem-mle"><i class="fa fa-check"></i><b>8.4</b> Problem: MLE</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-answers-mle.html"><a href="model-answers-mle.html"><i class="fa fa-check"></i>Model Answers: MLE</a></li>
<li class="chapter" data-level="9" data-path="confidence-intervals.html"><a href="confidence-intervals.html"><i class="fa fa-check"></i><b>9</b> Confidence Intervals</a>
<ul>
<li class="chapter" data-level="9.1" data-path="confidence-intervals.html"><a href="confidence-intervals.html#setup"><i class="fa fa-check"></i><b>9.1</b> Setup</a></li>
<li class="chapter" data-level="9.2" data-path="confidence-intervals.html"><a href="confidence-intervals.html#simulating-data"><i class="fa fa-check"></i><b>9.2</b> Simulating data</a></li>
<li class="chapter" data-level="9.3" data-path="confidence-intervals.html"><a href="confidence-intervals.html#constructing-the-confidence-interval"><i class="fa fa-check"></i><b>9.3</b> Constructing the confidence interval</a></li>
<li class="chapter" data-level="9.4" data-path="confidence-intervals.html"><a href="confidence-intervals.html#experiment"><i class="fa fa-check"></i><b>9.4</b> Experiment</a></li>
<li class="chapter" data-level="9.5" data-path="confidence-intervals.html"><a href="confidence-intervals.html#problem-confidence-interval"><i class="fa fa-check"></i><b>9.5</b> Problem: Confidence Interval</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-answer-confidence-interval.html"><a href="model-answer-confidence-interval.html"><i class="fa fa-check"></i>Model Answer: Confidence Interval</a></li>
<li class="chapter" data-level="10" data-path="computational-testing-techniques.html"><a href="computational-testing-techniques.html"><i class="fa fa-check"></i><b>10</b> Computational Testing Techniques</a>
<ul>
<li class="chapter" data-level="10.1" data-path="computational-testing-techniques.html"><a href="computational-testing-techniques.html#problem-1-1"><i class="fa fa-check"></i><b>10.1</b> Problem 1</a></li>
<li class="chapter" data-level="10.2" data-path="computational-testing-techniques.html"><a href="computational-testing-techniques.html#problem-2-1"><i class="fa fa-check"></i><b>10.2</b> Problem 2</a></li>
<li class="chapter" data-level="10.3" data-path="computational-testing-techniques.html"><a href="computational-testing-techniques.html#problem-3"><i class="fa fa-check"></i><b>10.3</b> Problem 3</a></li>
<li class="chapter" data-level="10.4" data-path="computational-testing-techniques.html"><a href="computational-testing-techniques.html#problem-4"><i class="fa fa-check"></i><b>10.4</b> Problem 4</a></li>
<li class="chapter" data-level="10.5" data-path="computational-testing-techniques.html"><a href="computational-testing-techniques.html#problem-5"><i class="fa fa-check"></i><b>10.5</b> Problem 5</a></li>
<li class="chapter" data-level="10.6" data-path="computational-testing-techniques.html"><a href="computational-testing-techniques.html#problem-7"><i class="fa fa-check"></i><b>10.6</b> Problem 7</a></li>
<li class="chapter" data-level="10.7" data-path="computational-testing-techniques.html"><a href="computational-testing-techniques.html#problem-8"><i class="fa fa-check"></i><b>10.7</b> Problem 8</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-answers-computational-testing.html"><a href="model-answers-computational-testing.html"><i class="fa fa-check"></i>Model Answers: Computational Testing</a>
<ul>
<li class="chapter" data-level="10.8" data-path="model-answers-computational-testing.html"><a href="model-answers-computational-testing.html#problem-1-2"><i class="fa fa-check"></i><b>10.8</b> Problem 1</a></li>
<li class="chapter" data-level="10.9" data-path="model-answers-computational-testing.html"><a href="model-answers-computational-testing.html#problem-2-2"><i class="fa fa-check"></i><b>10.9</b> Problem 2</a></li>
<li class="chapter" data-level="10.10" data-path="model-answers-computational-testing.html"><a href="model-answers-computational-testing.html#problem-3-1"><i class="fa fa-check"></i><b>10.10</b> Problem 3</a></li>
<li class="chapter" data-level="10.11" data-path="model-answers-computational-testing.html"><a href="model-answers-computational-testing.html#problem-4-1"><i class="fa fa-check"></i><b>10.11</b> Problem 4</a></li>
<li class="chapter" data-level="10.12" data-path="model-answers-computational-testing.html"><a href="model-answers-computational-testing.html#problem-5-1"><i class="fa fa-check"></i><b>10.12</b> Problem 5</a></li>
<li class="chapter" data-level="10.13" data-path="model-answers-computational-testing.html"><a href="model-answers-computational-testing.html#problem-6"><i class="fa fa-check"></i><b>10.13</b> Problem 6</a></li>
<li class="chapter" data-level="10.14" data-path="model-answers-computational-testing.html"><a href="model-answers-computational-testing.html#problem-7-1"><i class="fa fa-check"></i><b>10.14</b> Problem 7</a></li>
<li class="chapter" data-level="10.15" data-path="model-answers-computational-testing.html"><a href="model-answers-computational-testing.html#problem-8-1"><i class="fa fa-check"></i><b>10.15</b> Problem 8</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html"><i class="fa fa-check"></i><b>11</b> Practical: Linear regression</a>
<ul>
<li class="chapter" data-level="11.1" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#data"><i class="fa fa-check"></i><b>11.1</b> Data</a></li>
<li class="chapter" data-level="11.2" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#simulating-data-1"><i class="fa fa-check"></i><b>11.2</b> Simulating data</a></li>
<li class="chapter" data-level="11.3" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#fitting-simple-linear-regression-model"><i class="fa fa-check"></i><b>11.3</b> Fitting simple linear regression model</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#least-squared-estimation"><i class="fa fa-check"></i><b>11.3.1</b> Least squared estimation</a></li>
<li class="chapter" data-level="11.3.2" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#maximum-likelihood-estimation"><i class="fa fa-check"></i><b>11.3.2</b> Maximum likelihood estimation</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#effect-of-variance"><i class="fa fa-check"></i><b>11.4</b> Effect of variance</a></li>
<li class="chapter" data-level="11.5" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#exercise"><i class="fa fa-check"></i><b>11.5</b> Exercise</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#part-i"><i class="fa fa-check"></i><b>11.5.1</b> Part I</a></li>
<li class="chapter" data-level="11.5.2" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#part-ii"><i class="fa fa-check"></i><b>11.5.2</b> Part II</a></li>
<li class="chapter" data-level="11.5.3" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#part-iii"><i class="fa fa-check"></i><b>11.5.3</b> Part III</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-answers-linear-regression.html"><a href="model-answers-linear-regression.html"><i class="fa fa-check"></i>Model answers: Linear regression</a>
<ul>
<li class="chapter" data-level="11.6" data-path="model-answers-linear-regression.html"><a href="model-answers-linear-regression.html#exercise-i"><i class="fa fa-check"></i><b>11.6</b> Exercise I</a></li>
<li class="chapter" data-level="11.7" data-path="model-answers-linear-regression.html"><a href="model-answers-linear-regression.html#exercise-ii"><i class="fa fa-check"></i><b>11.7</b> Exercise II</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="model-answers-linear-regression.html"><a href="model-answers-linear-regression.html#comparison-of-data"><i class="fa fa-check"></i><b>11.7.1</b> Comparison of data</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="model-answers-linear-regression.html"><a href="model-answers-linear-regression.html#exercise-ii-1"><i class="fa fa-check"></i><b>11.8</b> Exercise II</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="practical-principal-component-analysis.html"><a href="practical-principal-component-analysis.html"><i class="fa fa-check"></i><b>12</b> Practical: Principal component analysis</a>
<ul>
<li class="chapter" data-level="12.1" data-path="practical-principal-component-analysis.html"><a href="practical-principal-component-analysis.html#data-1"><i class="fa fa-check"></i><b>12.1</b> Data</a></li>
<li class="chapter" data-level="12.2" data-path="practical-principal-component-analysis.html"><a href="practical-principal-component-analysis.html#introduction-1"><i class="fa fa-check"></i><b>12.2</b> Introduction</a></li>
<li class="chapter" data-level="12.3" data-path="practical-principal-component-analysis.html"><a href="practical-principal-component-analysis.html#exercise-i-1"><i class="fa fa-check"></i><b>12.3</b> Exercise I</a></li>
<li class="chapter" data-level="12.4" data-path="practical-principal-component-analysis.html"><a href="practical-principal-component-analysis.html#exercise-ii-2"><i class="fa fa-check"></i><b>12.4</b> Exercise II</a></li>
<li class="chapter" data-level="12.5" data-path="practical-principal-component-analysis.html"><a href="practical-principal-component-analysis.html#exercise-iii"><i class="fa fa-check"></i><b>12.5</b> Exercise III</a></li>
<li class="chapter" data-level="12.6" data-path="practical-principal-component-analysis.html"><a href="practical-principal-component-analysis.html#exercise-iv-single-cell-data"><i class="fa fa-check"></i><b>12.6</b> Exercise IV: Single cell data</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="practical-multiple-regression.html"><a href="practical-multiple-regression.html"><i class="fa fa-check"></i><b>13</b> Practical: Multiple regression</a>
<ul>
<li class="chapter" data-level="13.1" data-path="practical-multiple-regression.html"><a href="practical-multiple-regression.html#multiple-regression"><i class="fa fa-check"></i><b>13.1</b> Multiple regression</a></li>
<li class="chapter" data-level="13.2" data-path="practical-multiple-regression.html"><a href="practical-multiple-regression.html#categorical-covariates"><i class="fa fa-check"></i><b>13.2</b> Categorical covariates</a></li>
<li class="chapter" data-level="13.3" data-path="practical-multiple-regression.html"><a href="practical-multiple-regression.html#residuals"><i class="fa fa-check"></i><b>13.3</b> Residuals</a></li>
<li class="chapter" data-level="13.4" data-path="practical-multiple-regression.html"><a href="practical-multiple-regression.html#gradient-descent-algorithm"><i class="fa fa-check"></i><b>13.4</b> Gradient descent algorithm (+)</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html"><i class="fa fa-check"></i><b>14</b> Practical: Generalised linear models</a>
<ul>
<li class="chapter" data-level="14.1" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#data-2"><i class="fa fa-check"></i><b>14.1</b> Data</a></li>
<li class="chapter" data-level="14.2" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#detecting-snp-associations"><i class="fa fa-check"></i><b>14.2</b> Detecting SNP associations</a></li>
<li class="chapter" data-level="14.3" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#gwas-and-logistic-regression"><i class="fa fa-check"></i><b>14.3</b> GWAS and logistic regression</a></li>
<li class="chapter" data-level="14.4" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#negative-binomial-and-poisson-regression"><i class="fa fa-check"></i><b>14.4</b> Negative binomial and Poisson regression</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#count-based-glms"><i class="fa fa-check"></i><b>14.4.1</b> Count-based GLMs</a></li>
<li class="chapter" data-level="14.4.2" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#fitting-a-glm"><i class="fa fa-check"></i><b>14.4.2</b> Fitting a GLM</a></li>
<li class="chapter" data-level="14.4.3" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#comparing-nested-models"><i class="fa fa-check"></i><b>14.4.3</b> Comparing nested models</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#negative-binomial-vs-poisson-glms"><i class="fa fa-check"></i><b>14.5</b> Negative-Binomial vs Poisson GLMs</a></li>
<li class="chapter" data-level="14.6" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#further-understanding-the-model-optional"><i class="fa fa-check"></i><b>14.6</b> Further understanding the model (<strong>OPTIONAL</strong>)</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Essentials of Mathematics and Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="monte-carlo-methods" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Monte Carlo Methods</h1>
<p>Monte Carlo (MC) simulations provide a means to model a problem and apply brute force computational power to achieve a solution - randomly simulate from a model until you get an answer. The best way to explain is to just run through a bunch of examples, so lets go!</p>
<div id="integration" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Integration</h2>
<p>We will start with basic integration. Suppose we have an instance of a Normal distribution with a mean of 1 and a standard deviation of 2 then we want to find the <em>integral</em> (area under the curve) from 1 to 3:</p>
<p><span class="math display">\[
 \int_1^3 \frac{1}{10 \sqrt{2\,\pi}}\, e^{- \frac{(x - 1)^2}{2\times 2^2}}dx
\]</span></p>
<p>which we can visualise as follows:</p>
<p><img src="Practicals-module_1_files/figure-html/unnamed-chunk-26-1.png" width="90%" /></p>
<p>If you have not done calculus before - do not worry. We are going to write a Monte Carlo approach for estimating this integral which does not require any knowledge of calculus!</p>
<p>The method relies on being able to generate samples from this distribution and counting how many values fall between 1 and 3. The proportion of samples that fall in this range over the total number of samples gives the area.</p>
<p>First, create a new <code>R</code> script in <code>Rstudio</code>. Next we define the number of samples we will obtain. Lets choose 10,000</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="monte-carlo-methods.html#cb24-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># number of samples to take</span></span></code></pre></div>
<p>Now we use the <code>R</code> function <code>rnorm</code> to simulate 100 numbers from a Normal distribution with mean 1 and standard deviation 2:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="monte-carlo-methods.html#cb25-1" aria-hidden="true" tabindex="-1"></a>sims <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">2</span>) <span class="co"># simulated normally distributed numbers</span></span></code></pre></div>
<p>Lets estimate the integral between 1 and 3 by counting how many samples had a value in this range:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="monte-carlo-methods.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># find proportion of values between 1-3</span></span>
<span id="cb26-2"><a href="monte-carlo-methods.html#cb26-2" aria-hidden="true" tabindex="-1"></a>mc_integral <span class="ot">&lt;-</span> <span class="fu">sum</span>(sims <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> sims <span class="sc">&lt;=</span> <span class="dv">3</span>) <span class="sc">/</span> n</span></code></pre></div>
<p>The result we get is:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="monte-carlo-methods.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mc_integral)</span></code></pre></div>
<pre><code>## [1] 0.36</code></pre>
<p>The exact answer given using the cumulative distribution function <code>pnorm</code> in R is given by:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="monte-carlo-methods.html#cb29-1" aria-hidden="true" tabindex="-1"></a>mc_exact <span class="ot">=</span> <span class="fu">pnorm</span>(<span class="at">q=</span><span class="dv">3</span>, <span class="at">mean=</span><span class="dv">1</span>, <span class="at">sd=</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="at">q=</span><span class="dv">1</span>, <span class="at">mean=</span><span class="dv">1</span>, <span class="at">sd=</span><span class="dv">2</span>)</span>
<span id="cb29-2"><a href="monte-carlo-methods.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mc_exact)</span></code></pre></div>
<pre><code>## [1] 0.3413447</code></pre>
<p>The <code>pnorm</code> gives the integral under the Normal distribution (in this case with mean 1 and standard deviation 2) from negative infinity up to the value specified by <code>q</code>.</p>
<p>The first call to <code>pnorm(q=3, mean=1, sd=2)</code> gives us this integral:</p>
<p><img src="Practicals-module_1_files/figure-html/unnamed-chunk-32-1.png" width="90%" /></p>
<p>The second call to <code>pnorm(q=1, mean=1, sd=2)</code> gives us this integral:</p>
<p><img src="Practicals-module_1_files/figure-html/unnamed-chunk-33-1.png" width="90%" /></p>
<p>Therefore the difference between these gives us the integral of interest.</p>
<p><strong>The Monte Carlo estimate is a fairly good approximation to the true value!</strong></p>
</div>
<div id="problem-mc-accuracy" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Problem: MC accuracy</h2>
<blockquote>
<ol style="list-style-type: decimal">
<li>Try increasing the number of simulations and see how the accuracy improves?</li>
<li>Can you draw a graph of number of MC samples vs accuracy?</li>
</ol>
</blockquote>
<p><em>Model answers are in the next section</em></p>
</div>
<div id="approximating-the-binomial-distribution" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Approximating the Binomial Distribution</h2>
<p>We flip a coin 10 times and we want to know the probability of getting more than 3 heads. This is a trivial problem using the Binomial distribution but suppose we have forgotten about this or never learned it in the first place.</p>
<p>Lets solve this problem with a Monte Carlo simulation. We will use the common trick of representing tails with 0 and heads with 1, then simulate 10 coin tosses 100 times and see how often that happens.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="monte-carlo-methods.html#cb31-1" aria-hidden="true" tabindex="-1"></a>runs <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># number of simulations to run</span></span>
<span id="cb31-2"><a href="monte-carlo-methods.html#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="monte-carlo-methods.html#cb31-3" aria-hidden="true" tabindex="-1"></a>greater_than_three <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, runs) <span class="co"># vector to hold outcomes</span></span>
<span id="cb31-4"><a href="monte-carlo-methods.html#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="monte-carlo-methods.html#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># run 100 simulations</span></span>
<span id="cb31-6"><a href="monte-carlo-methods.html#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>runs) {</span>
<span id="cb31-7"><a href="monte-carlo-methods.html#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="monte-carlo-methods.html#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># flip a coin ten times (0 - tail, 1 - head)</span></span>
<span id="cb31-9"><a href="monte-carlo-methods.html#cb31-9" aria-hidden="true" tabindex="-1"></a>  coin_flips <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">10</span>, <span class="at">replace =</span> T)</span>
<span id="cb31-10"><a href="monte-carlo-methods.html#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="monte-carlo-methods.html#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># count how many heads and check if greater than 3</span></span>
<span id="cb31-12"><a href="monte-carlo-methods.html#cb31-12" aria-hidden="true" tabindex="-1"></a>  greater_than_three[i] <span class="ot">&lt;-</span> (<span class="fu">sum</span>(coin_flips) <span class="sc">&gt;</span> <span class="dv">3</span>)</span>
<span id="cb31-13"><a href="monte-carlo-methods.html#cb31-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-14"><a href="monte-carlo-methods.html#cb31-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-15"><a href="monte-carlo-methods.html#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="co"># compute average over simulations</span></span>
<span id="cb31-16"><a href="monte-carlo-methods.html#cb31-16" aria-hidden="true" tabindex="-1"></a>pr_greater_than_three <span class="ot">&lt;-</span> <span class="fu">sum</span>(greater_than_three) <span class="sc">/</span> runs</span></code></pre></div>
<p>For our MC estimate of the probability <span class="math inline">\(P(X&gt;3)\)</span> we get</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="monte-carlo-methods.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pr_greater_than_three)</span></code></pre></div>
<pre><code>## [1] 0.77</code></pre>
<p>which we can compare to R’s built-in Binomial distribution function:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="monte-carlo-methods.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">pbinom</span>(<span class="dv">3</span>, <span class="dv">10</span>, <span class="fl">0.5</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<pre><code>## [1] 0.828125</code></pre>
</div>
<div id="problem-mc-binomial" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Problem: MC Binomial</h2>
<blockquote>
<ol style="list-style-type: decimal">
<li>Try increasing the number of simulations and see how the accuracy improves?</li>
<li>Can you plot how the accuracy varies as a function of the number of simulations? (hint: see the previous section)</li>
</ol>
</blockquote>
<p>Not bad! <strong>The Monte Carlo estimate is close to the true value.</strong></p>
</div>
<div id="monte-carlo-expectations" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Monte Carlo Expectations</h2>
<p>Consider the following spinner. If the spinner is spun randomly then it has a probability 0.5 of landing on yellow and 0.25 of landing on red or blue respectively.</p>
<p><img src="Practicals-module_1_files/figure-html/unnamed-chunk-37-1.png" width="20%" /></p>
<p>If the rules of the game are such that landing on ‘yellow’ you gain 1 point, ‘red’ you lose 1 point and ‘blue’ you gain 2 points. We can easily calculate the expected score.</p>
<p>Let <span class="math inline">\(X\)</span> denote the random variable associated with the score of the spin then:</p>
<p><span class="math display">\[
    E[X] = \frac{1}{2} \times 1 + \frac{1}{4} \times (-1) + \frac{1}{4} \times 2 = 0.75
\]</span></p>
<p>If we ask a more challenging question such as:</p>
<blockquote>
<p><strong>After 20 spins what is the probability that you will have less then 0 points?“</strong></p>
</blockquote>
<p>How might we solve this?</p>
<p>Of course, there are methods to analytically solve this type of problem but by the time they are even explained we could have already written our simulation!</p>
<p>To solve this with a Monte Carlo simulation you need to sample from the Spinner 20 times, and return 1 if we are below 0 other wise we’ll return 0. We will repeat this 10,000 times to see how often it happens!</p>
</div>
<div id="using-functions" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> Using Functions</h2>
<p>First, we are going to introduce the concept of a function. This is a piece of code which is encapsulated so then we can refer to it repeated via the name of the function rather than repeatedly writing those lines of code. The function we will write will simulate one game as indicated above and return whether the number of points is less than zero.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="monte-carlo-methods.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulates a game of 20 spins</span></span>
<span id="cb36-2"><a href="monte-carlo-methods.html#cb36-2" aria-hidden="true" tabindex="-1"></a>play_game <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb36-3"><a href="monte-carlo-methods.html#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># picks a number from the list (1, -1, 2)</span></span>
<span id="cb36-4"><a href="monte-carlo-methods.html#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># with probability 50%, 25% and 25% twenty times</span></span>
<span id="cb36-5"><a href="monte-carlo-methods.html#cb36-5" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>), <span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>))</span>
<span id="cb36-6"><a href="monte-carlo-methods.html#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="monte-carlo-methods.html#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># function returns whether the sum of all the spins is &lt; 1</span></span>
<span id="cb36-8"><a href="monte-carlo-methods.html#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(results) <span class="sc">&lt;</span> <span class="dv">0</span>)</span>
<span id="cb36-9"><a href="monte-carlo-methods.html#cb36-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="simulating-from-function" class="section level2" number="7.7">
<h2><span class="header-section-number">7.7</span> Simulating from function</h2>
<p>Now we can use this function in a loop to play the game 100 times:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="monte-carlo-methods.html#cb37-1" aria-hidden="true" tabindex="-1"></a>runs <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># play the game 100 times</span></span>
<span id="cb37-2"><a href="monte-carlo-methods.html#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="monte-carlo-methods.html#cb37-3" aria-hidden="true" tabindex="-1"></a>less_than_zero <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, runs) <span class="co"># vector to store outcome of each game</span></span>
<span id="cb37-4"><a href="monte-carlo-methods.html#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (it <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>runs) {</span>
<span id="cb37-5"><a href="monte-carlo-methods.html#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># play the game by calling the function and store the outcome</span></span>
<span id="cb37-6"><a href="monte-carlo-methods.html#cb37-6" aria-hidden="true" tabindex="-1"></a>  less_than_zero[it] <span class="ot">&lt;-</span> <span class="fu">play_game</span>()</span>
<span id="cb37-7"><a href="monte-carlo-methods.html#cb37-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We can then compute the probability that, after twenty spins, we will have less than zero points:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="monte-carlo-methods.html#cb38-1" aria-hidden="true" tabindex="-1"></a>prob_less_than_zero <span class="ot">&lt;-</span> <span class="fu">sum</span>(less_than_zero)<span class="sc">/</span>runs</span>
<span id="cb38-2"><a href="monte-carlo-methods.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(prob_less_than_zero)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>The probability is very low. This is not surprising since there is only a 25% chance of getting a point deduction on any spin and a 75% chance of gaining points. Try to increase the number of simulation runs to see if you can detect any games where you do find a negative score.</p>
</div>
<div id="problem-mc-expectation" class="section level2" number="7.8">
<h2><span class="header-section-number">7.8</span> Problem: MC Expectation</h2>
<blockquote>
<ol style="list-style-type: decimal">
<li>Modify your code to allow you to calculate the expected number of points after 20 spins.</li>
<li>Simulate a game in which you have a maximum of 20 spins but you go “bust” once you hit a negative score and take this into account when you compute the expected end of game score.</li>
</ol>
</blockquote>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="a-monopoly-simulation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="model-answers-monte-carlo.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Practicals-module_1.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
