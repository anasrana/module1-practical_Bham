<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>12 Practical: Multiple regression | Essentials of Mathematics and Statistics</title>
  <meta name="description" content="This contains practicals for Module 1 (Essentials of Mathematics and Statistics)." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="12 Practical: Multiple regression | Essentials of Mathematics and Statistics" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://anasrana.github.io/module1-practical_Bham/" />
  
  <meta property="og:description" content="This contains practicals for Module 1 (Essentials of Mathematics and Statistics)." />
  <meta name="github-repo" content="anasrana/module1-practical_Bham" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="12 Practical: Multiple regression | Essentials of Mathematics and Statistics" />
  
  <meta name="twitter:description" content="This contains practicals for Module 1 (Essentials of Mathematics and Statistics)." />
  

<meta name="author" content="Anas A Rana" />


<meta name="date" content="2021-10-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="practical-principal-component-analysis.html"/>
<link rel="next" href="practical-generalised-linear-models.html"/>
<script src="assets/header-attrs-2.11/header-attrs.js"></script>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Essentials of Mathematics and Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#how-to-use-these-resources"><i class="fa fa-check"></i><b>1.1</b> How to use these resources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started-in-r-and-rstudio.html"><a href="getting-started-in-r-and-rstudio.html"><i class="fa fa-check"></i><b>2</b> Getting started in R and Rstudio</a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started-in-r-and-rstudio.html"><a href="getting-started-in-r-and-rstudio.html#r-scripts"><i class="fa fa-check"></i><b>2.1</b> R scripts</a></li>
<li class="chapter" data-level="2.2" data-path="getting-started-in-r-and-rstudio.html"><a href="getting-started-in-r-and-rstudio.html#creating-an-r-script"><i class="fa fa-check"></i><b>2.2</b> Creating an R script</a></li>
<li class="chapter" data-level="2.3" data-path="getting-started-in-r-and-rstudio.html"><a href="getting-started-in-r-and-rstudio.html#saving-an-r-script"><i class="fa fa-check"></i><b>2.3</b> Saving an R script</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started-in-r-and-rstudio.html"><a href="getting-started-in-r-and-rstudio.html#executing-code-in-an-r-script"><i class="fa fa-check"></i><b>2.4</b> Executing code in an R script</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="getting-started-in-r-and-rstudio.html"><a href="getting-started-in-r-and-rstudio.html#comments-in-an-r-script-documenting-your-code"><i class="fa fa-check"></i><b>2.4.1</b> Comments in an R script (documenting your code)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-sets.html"><a href="data-sets.html"><i class="fa fa-check"></i><b>3</b> Data sets</a></li>
<li class="chapter" data-level="4" data-path="simulating-random-numbers.html"><a href="simulating-random-numbers.html"><i class="fa fa-check"></i><b>4</b> Simulating random numbers</a></li>
<li class="chapter" data-level="5" data-path="markov-chains.html"><a href="markov-chains.html"><i class="fa fa-check"></i><b>5</b> Markov Chains</a></li>
<li class="chapter" data-level="" data-path="model-answers-3-state-markov-chain.html"><a href="model-answers-3-state-markov-chain.html"><i class="fa fa-check"></i>Model answers 3 state Markov Chain</a></li>
<li class="chapter" data-level="6" data-path="a-monopoly-simulation.html"><a href="a-monopoly-simulation.html"><i class="fa fa-check"></i><b>6</b> A Monopoly simulation</a>
<ul>
<li class="chapter" data-level="6.1" data-path="a-monopoly-simulation.html"><a href="a-monopoly-simulation.html#moving-around-the-board"><i class="fa fa-check"></i><b>6.1</b> Moving around the board</a></li>
<li class="chapter" data-level="6.2" data-path="a-monopoly-simulation.html"><a href="a-monopoly-simulation.html#going-to-jail"><i class="fa fa-check"></i><b>6.2</b> Going to Jail</a></li>
<li class="chapter" data-level="6.3" data-path="a-monopoly-simulation.html"><a href="a-monopoly-simulation.html#further-exercises"><i class="fa fa-check"></i><b>6.3</b> Further Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html"><i class="fa fa-check"></i><b>7</b> Monte Carlo Methods</a>
<ul>
<li class="chapter" data-level="7.1" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#integration"><i class="fa fa-check"></i><b>7.1</b> Integration</a></li>
<li class="chapter" data-level="7.2" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#problem-mc-accuracy"><i class="fa fa-check"></i><b>7.2</b> Problem: MC accuracy</a></li>
<li class="chapter" data-level="7.3" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#approximating-the-binomial-distribution"><i class="fa fa-check"></i><b>7.3</b> Approximating the Binomial Distribution</a></li>
<li class="chapter" data-level="7.4" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#problem-mc-binomial"><i class="fa fa-check"></i><b>7.4</b> Problem: MC Binomial</a></li>
<li class="chapter" data-level="7.5" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#monte-carlo-expectations"><i class="fa fa-check"></i><b>7.5</b> Monte Carlo Expectations</a></li>
<li class="chapter" data-level="7.6" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#using-functions"><i class="fa fa-check"></i><b>7.6</b> Using Functions</a></li>
<li class="chapter" data-level="7.7" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#simulating-from-function"><i class="fa fa-check"></i><b>7.7</b> Simulating from function</a></li>
<li class="chapter" data-level="7.8" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#problem-mc-expectation"><i class="fa fa-check"></i><b>7.8</b> Problem: MC Expectation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-answers-monte-carlo.html"><a href="model-answers-monte-carlo.html"><i class="fa fa-check"></i>Model Answers: Monte Carlo</a>
<ul>
<li class="chapter" data-level="7.9" data-path="model-answers-monte-carlo.html"><a href="model-answers-monte-carlo.html#problem-mc-accuracy-1"><i class="fa fa-check"></i><b>7.9</b> Problem: MC accuracy</a></li>
<li class="chapter" data-level="7.10" data-path="model-answers-monte-carlo.html"><a href="model-answers-monte-carlo.html#problem-mc-expectation-1"><i class="fa fa-check"></i><b>7.10</b> Problem: MC Expectation</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="model-answers-monte-carlo.html"><a href="model-answers-monte-carlo.html#problem-1"><i class="fa fa-check"></i><b>7.10.1</b> Problem 1</a></li>
<li class="chapter" data-level="7.10.2" data-path="model-answers-monte-carlo.html"><a href="model-answers-monte-carlo.html#problem-2"><i class="fa fa-check"></i><b>7.10.2</b> Problem 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html"><i class="fa fa-check"></i><b>8</b> Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="8.1" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#the-likelihood-function"><i class="fa fa-check"></i><b>8.1</b> The likelihood function</a></li>
<li class="chapter" data-level="8.2" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#optimisation"><i class="fa fa-check"></i><b>8.2</b> Optimisation</a></li>
<li class="chapter" data-level="8.3" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#two-parameter-estimation"><i class="fa fa-check"></i><b>8.3</b> Two-parameter estimation</a></li>
<li class="chapter" data-level="8.4" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#problem-mle"><i class="fa fa-check"></i><b>8.4</b> Problem: MLE</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-answers-mle.html"><a href="model-answers-mle.html"><i class="fa fa-check"></i>Model Answers: MLE</a></li>
<li class="chapter" data-level="9" data-path="confidence-intervals.html"><a href="confidence-intervals.html"><i class="fa fa-check"></i><b>9</b> Confidence Intervals</a>
<ul>
<li class="chapter" data-level="9.1" data-path="confidence-intervals.html"><a href="confidence-intervals.html#setup"><i class="fa fa-check"></i><b>9.1</b> Setup</a></li>
<li class="chapter" data-level="9.2" data-path="confidence-intervals.html"><a href="confidence-intervals.html#simulating-data"><i class="fa fa-check"></i><b>9.2</b> Simulating data</a></li>
<li class="chapter" data-level="9.3" data-path="confidence-intervals.html"><a href="confidence-intervals.html#constructing-the-confidence-interval"><i class="fa fa-check"></i><b>9.3</b> Constructing the confidence interval</a></li>
<li class="chapter" data-level="9.4" data-path="confidence-intervals.html"><a href="confidence-intervals.html#experiment"><i class="fa fa-check"></i><b>9.4</b> Experiment</a></li>
<li class="chapter" data-level="9.5" data-path="confidence-intervals.html"><a href="confidence-intervals.html#problem-confidence-interval"><i class="fa fa-check"></i><b>9.5</b> Problem: Confidence Interval</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-answer-confidence-interval.html"><a href="model-answer-confidence-interval.html"><i class="fa fa-check"></i>Model Answer: Confidence Interval</a></li>
<li class="chapter" data-level="10" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html"><i class="fa fa-check"></i><b>10</b> Practical: Linear regression</a>
<ul>
<li class="chapter" data-level="10.1" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#data"><i class="fa fa-check"></i><b>10.1</b> Data</a></li>
<li class="chapter" data-level="10.2" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#simulating-data-1"><i class="fa fa-check"></i><b>10.2</b> Simulating data</a></li>
<li class="chapter" data-level="10.3" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#fitting-simple-linear-regression-model"><i class="fa fa-check"></i><b>10.3</b> Fitting simple linear regression model</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#least-squared-estimation"><i class="fa fa-check"></i><b>10.3.1</b> Least squared estimation</a></li>
<li class="chapter" data-level="10.3.2" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#maximum-likelihood-estimation"><i class="fa fa-check"></i><b>10.3.2</b> Maximum likelihood estimation</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#effect-of-variance"><i class="fa fa-check"></i><b>10.4</b> Effect of variance</a></li>
<li class="chapter" data-level="10.5" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#exercise"><i class="fa fa-check"></i><b>10.5</b> Exercise</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#part-i"><i class="fa fa-check"></i><b>10.5.1</b> Part I</a></li>
<li class="chapter" data-level="10.5.2" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#part-ii"><i class="fa fa-check"></i><b>10.5.2</b> Part II</a></li>
<li class="chapter" data-level="10.5.3" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#part-iii"><i class="fa fa-check"></i><b>10.5.3</b> Part III</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-answers-linear-regression.html"><a href="model-answers-linear-regression.html"><i class="fa fa-check"></i>Model answers: Linear regression</a>
<ul>
<li class="chapter" data-level="10.6" data-path="model-answers-linear-regression.html"><a href="model-answers-linear-regression.html#exercise-i"><i class="fa fa-check"></i><b>10.6</b> Exercise I</a></li>
<li class="chapter" data-level="10.7" data-path="model-answers-linear-regression.html"><a href="model-answers-linear-regression.html#exercise-ii"><i class="fa fa-check"></i><b>10.7</b> Exercise II</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="model-answers-linear-regression.html"><a href="model-answers-linear-regression.html#comparison-of-data"><i class="fa fa-check"></i><b>10.7.1</b> Comparison of data</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="model-answers-linear-regression.html"><a href="model-answers-linear-regression.html#exercise-ii-1"><i class="fa fa-check"></i><b>10.8</b> Exercise II</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="practical-principal-component-analysis.html"><a href="practical-principal-component-analysis.html"><i class="fa fa-check"></i><b>11</b> Practical: Principal component analysis</a>
<ul>
<li class="chapter" data-level="11.1" data-path="practical-principal-component-analysis.html"><a href="practical-principal-component-analysis.html#data-1"><i class="fa fa-check"></i><b>11.1</b> Data</a></li>
<li class="chapter" data-level="11.2" data-path="practical-principal-component-analysis.html"><a href="practical-principal-component-analysis.html#introduction-1"><i class="fa fa-check"></i><b>11.2</b> Introduction</a></li>
<li class="chapter" data-level="11.3" data-path="practical-principal-component-analysis.html"><a href="practical-principal-component-analysis.html#exercise-i-1"><i class="fa fa-check"></i><b>11.3</b> Exercise I</a></li>
<li class="chapter" data-level="11.4" data-path="practical-principal-component-analysis.html"><a href="practical-principal-component-analysis.html#exercise-ii-2"><i class="fa fa-check"></i><b>11.4</b> Exercise II</a></li>
<li class="chapter" data-level="11.5" data-path="practical-principal-component-analysis.html"><a href="practical-principal-component-analysis.html#exercise-iii"><i class="fa fa-check"></i><b>11.5</b> Exercise III</a></li>
<li class="chapter" data-level="11.6" data-path="practical-principal-component-analysis.html"><a href="practical-principal-component-analysis.html#exercise-iv-single-cell-data"><i class="fa fa-check"></i><b>11.6</b> Exercise IV: Single cell data</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="practical-multiple-regression.html"><a href="practical-multiple-regression.html"><i class="fa fa-check"></i><b>12</b> Practical: Multiple regression</a>
<ul>
<li class="chapter" data-level="12.1" data-path="practical-multiple-regression.html"><a href="practical-multiple-regression.html#multiple-regression"><i class="fa fa-check"></i><b>12.1</b> Multiple regression</a></li>
<li class="chapter" data-level="12.2" data-path="practical-multiple-regression.html"><a href="practical-multiple-regression.html#categorical-covariates"><i class="fa fa-check"></i><b>12.2</b> Categorical covariates</a></li>
<li class="chapter" data-level="12.3" data-path="practical-multiple-regression.html"><a href="practical-multiple-regression.html#residuals"><i class="fa fa-check"></i><b>12.3</b> Residuals</a></li>
<li class="chapter" data-level="12.4" data-path="practical-multiple-regression.html"><a href="practical-multiple-regression.html#gradient-descent-algorithm"><i class="fa fa-check"></i><b>12.4</b> Gradient descent algorithm (+)</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html"><i class="fa fa-check"></i><b>13</b> Practical: Generalised linear models</a>
<ul>
<li class="chapter" data-level="13.1" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#data-2"><i class="fa fa-check"></i><b>13.1</b> Data</a></li>
<li class="chapter" data-level="13.2" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#detecting-snp-associations"><i class="fa fa-check"></i><b>13.2</b> Detecting SNP associations</a></li>
<li class="chapter" data-level="13.3" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#gwas-and-logistic-regression"><i class="fa fa-check"></i><b>13.3</b> GWAS and logistic regression</a></li>
<li class="chapter" data-level="13.4" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#negative-binomial-and-poisson-regression"><i class="fa fa-check"></i><b>13.4</b> Negative binomial and Poisson regression</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#count-based-glms"><i class="fa fa-check"></i><b>13.4.1</b> Count-based GLMs</a></li>
<li class="chapter" data-level="13.4.2" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#fitting-a-glm"><i class="fa fa-check"></i><b>13.4.2</b> Fitting a GLM</a></li>
<li class="chapter" data-level="13.4.3" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#comparing-nested-models"><i class="fa fa-check"></i><b>13.4.3</b> Comparing nested models</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#negative-binomial-vs-poisson-glms"><i class="fa fa-check"></i><b>13.5</b> Negative-Binomial vs Poisson GLMs</a></li>
<li class="chapter" data-level="13.6" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#further-understanding-the-model-optional"><i class="fa fa-check"></i><b>13.6</b> Further understanding the model (<strong>OPTIONAL</strong>)</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Essentials of Mathematics and Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="practical-multiple-regression" class="section level1" number="12">
<h1><span class="header-section-number">12</span> Practical: Multiple regression</h1>
<p>Previously we have only considered simple linear regression with one response variable and one feature. In this practical we will go through examples with multiple features:</p>
<p><span class="math display">\[y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \epsilon \]</span></p>
<p>For this practical we will use data that is already inbuilt in R or is part of the <code>MASS</code> package. The only thing we need to do to make the data available is load the <code>MASS</code> package.</p>
<!-- ```{r init}
# We load the MAASS package for plotting
library(MASS)

# We load the ggplot2 package for plotting
library(ggplot2)

``` -->
<div id="multiple-regression" class="section level2" number="12.1">
<h2><span class="header-section-number">12.1</span> Multiple regression</h2>
<p>For this part we will use the inbuilt <code>trees</code> dataset containing <code>Volume</code>, <code>Girth</code> and <code>Height</code> data for 31 trees.</p>
<p>First we revisit linear regression on this example, recall the function to fit a linear model <code>lm()</code>. Consider <code>Volume</code> to be the response variable and <code>Girth</code> to be the covariate.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="practical-multiple-regression.html#cb169-1" aria-hidden="true" tabindex="-1"></a>lr_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Volume <span class="sc">~</span> Girth, <span class="at">data =</span> trees)</span>
<span id="cb169-2"><a href="practical-multiple-regression.html#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lr_fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Volume ~ Girth, data = trees)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -8.065 -3.107  0.152  3.495  9.587 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -36.9435     3.3651  -10.98 7.62e-12 ***
## Girth         5.0659     0.2474   20.48  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.252 on 29 degrees of freedom
## Multiple R-squared:  0.9353, Adjusted R-squared:  0.9331 
## F-statistic: 419.4 on 1 and 29 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>We will now consider a linear regression example with multiple covariates, <code>Girth</code> as well as <code>Height</code>. In this case of course we know that they are related so we do expect both covariates to be significant.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="practical-multiple-regression.html#cb171-1" aria-hidden="true" tabindex="-1"></a>mr_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Volume <span class="sc">~</span> Girth <span class="sc">+</span> Height, <span class="at">data =</span> trees)</span>
<span id="cb171-2"><a href="practical-multiple-regression.html#cb171-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-3"><a href="practical-multiple-regression.html#cb171-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-4"><a href="practical-multiple-regression.html#cb171-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mr_fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Volume ~ Girth + Height, data = trees)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6.4065 -2.6493 -0.2876  2.2003  8.4847 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -57.9877     8.6382  -6.713 2.75e-07 ***
## Girth         4.7082     0.2643  17.816  &lt; 2e-16 ***
## Height        0.3393     0.1302   2.607   0.0145 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.882 on 28 degrees of freedom
## Multiple R-squared:  0.948,  Adjusted R-squared:  0.9442 
## F-statistic:   255 on 2 and 28 DF,  p-value: &lt; 2.2e-16</code></pre>
<p><em>Note</em>, in the formula you only enter the covariates and not the regression coefficients or any information regarding the noise.</p>
<p>Let us now look at RSS values, we can calculate the RSS for the <code>lf_fit</code> object by using <code>sum(residuals(lr_fit)^2)</code>. We see that the RSS for LR = 524.3 and the RSS for MR = 421.92. Therefore the fit has improved but the regression coefficient for <code>Height</code> is very small and not significant.</p>
<p>One reason for this is that the in the relationship between <code>Volume</code>, <code>Girth</code>, and <code>Height</code> is not additive but rather <code>Girth</code> and <code>Height</code> are multiplied. Using the fact that <span class="math inline">\(\log(a*b) = \log(a) + \log(b)\)</span> we can consider the log-transformed data in a linear model.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="practical-multiple-regression.html#cb173-1" aria-hidden="true" tabindex="-1"></a>mrl_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Volume) <span class="sc">~</span> <span class="fu">log</span>(Girth) <span class="sc">+</span> <span class="fu">log</span>(Height), <span class="at">data =</span> trees)</span>
<span id="cb173-2"><a href="practical-multiple-regression.html#cb173-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-3"><a href="practical-multiple-regression.html#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mrl_fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(Volume) ~ log(Girth) + log(Height), data = trees)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.168561 -0.048488  0.002431  0.063637  0.129223 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -6.63162    0.79979  -8.292 5.06e-09 ***
## log(Girth)   1.98265    0.07501  26.432  &lt; 2e-16 ***
## log(Height)  1.11712    0.20444   5.464 7.81e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.08139 on 28 degrees of freedom
## Multiple R-squared:  0.9777, Adjusted R-squared:  0.9761 
## F-statistic: 613.2 on 2 and 28 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Now we see that the regression coefficient is large and both covariates are significant. This shows that we need to ensure we understand the relationship between covariates before we construct our model.</p>
</div>
<div id="categorical-covariates" class="section level2" number="12.2">
<h2><span class="header-section-number">12.2</span> Categorical covariates</h2>
<p>Recall from the lecture that covariates don’t need to be numerical but can also be <em>categorical</em>. We will now explore regression with a categorical variable. Load a new dataset which is included in the <code>MASS</code> package, you won’t be able to load this dataset if package isn’t installed. Load the dataset explore what the data looks like.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="practical-multiple-regression.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb175-2"><a href="practical-multiple-regression.html#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;birthwt&quot;</span>)</span>
<span id="cb175-3"><a href="practical-multiple-regression.html#cb175-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-4"><a href="practical-multiple-regression.html#cb175-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(birthwt)</span></code></pre></div>
<pre><code>##    low age lwt race smoke ptl ht ui ftv  bwt
## 85   0  19 182    2     0   0  0  1   0 2523
## 86   0  33 155    3     0   0  0  0   3 2551
## 87   0  20 105    1     1   0  0  0   1 2557
## 88   0  21 108    1     1   0  0  1   2 2594
## 89   0  18 107    1     1   0  0  1   0 2600
## 91   0  21 124    3     0   0  0  0   0 2622</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="practical-multiple-regression.html#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(birthwt)</span></code></pre></div>
<pre><code>##       low              age             lwt             race           smoke       
##  Min.   :0.0000   Min.   :14.00   Min.   : 80.0   Min.   :1.000   Min.   :0.0000  
##  1st Qu.:0.0000   1st Qu.:19.00   1st Qu.:110.0   1st Qu.:1.000   1st Qu.:0.0000  
##  Median :0.0000   Median :23.00   Median :121.0   Median :1.000   Median :0.0000  
##  Mean   :0.3122   Mean   :23.24   Mean   :129.8   Mean   :1.847   Mean   :0.3915  
##  3rd Qu.:1.0000   3rd Qu.:26.00   3rd Qu.:140.0   3rd Qu.:3.000   3rd Qu.:1.0000  
##  Max.   :1.0000   Max.   :45.00   Max.   :250.0   Max.   :3.000   Max.   :1.0000  
##       ptl               ht                ui              ftv              bwt      
##  Min.   :0.0000   Min.   :0.00000   Min.   :0.0000   Min.   :0.0000   Min.   : 709  
##  1st Qu.:0.0000   1st Qu.:0.00000   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:2414  
##  Median :0.0000   Median :0.00000   Median :0.0000   Median :0.0000   Median :2977  
##  Mean   :0.1958   Mean   :0.06349   Mean   :0.1481   Mean   :0.7937   Mean   :2945  
##  3rd Qu.:0.0000   3rd Qu.:0.00000   3rd Qu.:0.0000   3rd Qu.:1.0000   3rd Qu.:3487  
##  Max.   :3.0000   Max.   :1.00000   Max.   :1.0000   Max.   :6.0000   Max.   :4990</code></pre>
<p>We will give the data more interpretable names and generally cleanup the data a little bit.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="practical-multiple-regression.html#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rename columns</span></span>
<span id="cb179-2"><a href="practical-multiple-regression.html#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(birthwt) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;bwt_below_2500&quot;</span>, <span class="st">&quot;mother_age&quot;</span>, <span class="st">&quot;mother_weight&quot;</span>, <span class="st">&quot;race&quot;</span>,</span>
<span id="cb179-3"><a href="practical-multiple-regression.html#cb179-3" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;mother_smokes&quot;</span>, <span class="st">&quot;previous_prem_labor&quot;</span>, <span class="st">&quot;hypertension&quot;</span>,</span>
<span id="cb179-4"><a href="practical-multiple-regression.html#cb179-4" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;uterine_irr&quot;</span>, <span class="st">&quot;physician_visits&quot;</span>, <span class="st">&quot;bwt_grams&quot;</span>)</span>
<span id="cb179-5"><a href="practical-multiple-regression.html#cb179-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-6"><a href="practical-multiple-regression.html#cb179-6" aria-hidden="true" tabindex="-1"></a>birthwt<span class="sc">$</span>race <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;other&quot;</span>)[birthwt<span class="sc">$</span>race])</span>
<span id="cb179-7"><a href="practical-multiple-regression.html#cb179-7" aria-hidden="true" tabindex="-1"></a>birthwt<span class="sc">$</span>mother_smokes <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>)[birthwt<span class="sc">$</span>mother_smokes <span class="sc">+</span> <span class="dv">1</span>])</span>
<span id="cb179-8"><a href="practical-multiple-regression.html#cb179-8" aria-hidden="true" tabindex="-1"></a>birthwt<span class="sc">$</span>uterine_irr <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>)[birthwt<span class="sc">$</span>uterine_irr <span class="sc">+</span> <span class="dv">1</span>])</span>
<span id="cb179-9"><a href="practical-multiple-regression.html#cb179-9" aria-hidden="true" tabindex="-1"></a>birthwt<span class="sc">$</span>hypertension <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>)[birthwt<span class="sc">$</span>hypertension <span class="sc">+</span> <span class="dv">1</span>])</span>
<span id="cb179-10"><a href="practical-multiple-regression.html#cb179-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-11"><a href="practical-multiple-regression.html#cb179-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birthwt, <span class="fu">aes</span>(<span class="at">x =</span> mother_smokes, <span class="at">y =</span> bwt_grams)) <span class="sc">+</span></span>
<span id="cb179-12"><a href="practical-multiple-regression.html#cb179-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb179-13"><a href="practical-multiple-regression.html#cb179-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Data on baby births in Springfield (1986)&quot;</span>,</span>
<span id="cb179-14"><a href="practical-multiple-regression.html#cb179-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Does the mother smoke?&quot;</span>,</span>
<span id="cb179-15"><a href="practical-multiple-regression.html#cb179-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Birth-weight [grams]&quot;</span>)</span></code></pre></div>
<p><img src="Practicals-module_1_files/figure-html/bplt-1.png" width="2400" /></p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="practical-multiple-regression.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(birthwt, <span class="fu">aes</span>(<span class="at">x =</span> mother_age, <span class="at">y =</span> bwt_grams, <span class="at">col =</span> mother_smokes)) <span class="sc">+</span></span>
<span id="cb180-2"><a href="practical-multiple-regression.html#cb180-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="Practicals-module_1_files/figure-html/bwt_sct-1.png" width="3000" /></p>
<p>Now we perform linear regression using the categorical variable, it is no different than performing linear regression on numeric data. The difference is in interpretation.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="practical-multiple-regression.html#cb181-1" aria-hidden="true" tabindex="-1"></a>bwt_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(bwt_grams <span class="sc">~</span> mother_smokes, <span class="at">data =</span> birthwt)</span>
<span id="cb181-2"><a href="practical-multiple-regression.html#cb181-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-3"><a href="practical-multiple-regression.html#cb181-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bwt_fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = bwt_grams ~ mother_smokes, data = birthwt)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2062.9  -475.9    34.3   545.1  1934.3 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       3055.70      66.93  45.653  &lt; 2e-16 ***
## mother_smokesYes  -283.78     106.97  -2.653  0.00867 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 717.8 on 187 degrees of freedom
## Multiple R-squared:  0.03627,    Adjusted R-squared:  0.03112 
## F-statistic: 7.038 on 1 and 187 DF,  p-value: 0.008667</code></pre>
<p>When you put a categorical variable in the formula for <code>lm</code> as in this case <code>bwt_grams ~ mother_smokes</code> where we have two levels in the categorical variable. If we consider this model as <span class="math inline">\(y = \beta_0 + \beta_1 x + \epsilon\)</span>
The coefficients in the model can be interpreted as follows:</p>
<ul>
<li><span class="math inline">\(\beta_0\)</span> is average birth weight where the mother was a non smoker</li>
<li><span class="math inline">\(\beta_0 + \beta_1\)</span> is the average birth weight where the mother is a smoker</li>
<li><span class="math inline">\(\beta_1\)</span> is the average difference in birth weight for babies between mother that were smokers and mothers that were non smokers.</li>
</ul>
<p>Categorical variables can also have more than two levels and in those cases each additional level can be interpreted in the same way.</p>
</div>
<div id="residuals" class="section level2" number="12.3">
<h2><span class="header-section-number">12.3</span> Residuals</h2>
<p>Recall from the lectures the residuals are the differences between the observed data <span class="math inline">\(y\)</span> and the fitted values <span class="math inline">\(\hat{y}\)</span>. One of the assumptions we make in the simple linear regression model is that the residuals should be normally distributed. To extract residuals from an <code>lm</code> object we will use the <code>residuals()</code> function.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="practical-multiple-regression.html#cb183-1" aria-hidden="true" tabindex="-1"></a>residuals_df <span class="ot">&lt;-</span></span>
<span id="cb183-2"><a href="practical-multiple-regression.html#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">resid =</span> <span class="fu">residuals</span>(bwt_fit))</span>
<span id="cb183-3"><a href="practical-multiple-regression.html#cb183-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-4"><a href="practical-multiple-regression.html#cb183-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(residuals_df, <span class="fu">aes</span>(<span class="at">x =</span> resid)) <span class="sc">+</span></span>
<span id="cb183-5"><a href="practical-multiple-regression.html#cb183-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">10</span>)</span></code></pre></div>
<p><img src="Practicals-module_1_files/figure-html/bwt_resid-1.png" width="3000" /></p>
<p>Even if we consider that these residuals look like they are normally distributed we need to get better understanding of this we will use the Q-Q Plot. You can take a look at the wiki to get a better understanding (<a href="https://en.wikipedia.org/wiki/Q%E2%80%93Q_plot">Q–Q plot - Wikipedia</a>). In simple terms if the residuals are normally distributed we expect them to be on the diagonal straight line on a Q-Q plot. The simplest way to get such a plot is using the <code>plot()</code> function and specifically for an <code>lm</code> object it has an option <code>which =</code> that takes a numeric value depending on which plot you want to plot.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="practical-multiple-regression.html#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bwt_fit, <span class="at">which =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="Practicals-module_1_files/figure-html/qq-1.png" width="1800" /></p>
<p>As we can see in this example the residuals are very close to normal with some outliers especially towards larger values of the residual. This would indicate that the model as it stands does not fulfill that assumption fully but comes close.</p>
</div>
<div id="gradient-descent-algorithm" class="section level2" number="12.4">
<h2><span class="header-section-number">12.4</span> Gradient descent algorithm (+)</h2>
<p>Finally, in todays practical we will implement the <em>gradient descent algorithm</em> which we discussed in the lecture.</p>
<p>For simplicity we will only consider the case with one covariate. In this section we will use simulated data and compare the results with <code>lm()</code>. The model we will simulate from is:</p>
<p><span class="math display">\[y = 2 + 3 x + \epsilon\]</span></p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="practical-multiple-regression.html#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># setting seed to be able to reproduce the simulation</span></span>
<span id="cb185-2"><a href="practical-multiple-regression.html#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">200</span>)</span>
<span id="cb185-3"><a href="practical-multiple-regression.html#cb185-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-4"><a href="practical-multiple-regression.html#cb185-4" aria-hidden="true" tabindex="-1"></a><span class="co"># number of samples</span></span>
<span id="cb185-5"><a href="practical-multiple-regression.html#cb185-5" aria-hidden="true" tabindex="-1"></a>n_sample <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb185-6"><a href="practical-multiple-regression.html#cb185-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-7"><a href="practical-multiple-regression.html#cb185-7" aria-hidden="true" tabindex="-1"></a><span class="co"># We sample x values from a uniform distribution in the range [-5, 5]</span></span>
<span id="cb185-8"><a href="practical-multiple-regression.html#cb185-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_sample, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb185-9"><a href="practical-multiple-regression.html#cb185-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Next we compute y</span></span>
<span id="cb185-10"><a href="practical-multiple-regression.html#cb185-10" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n_sample, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb185-11"><a href="practical-multiple-regression.html#cb185-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-12"><a href="practical-multiple-regression.html#cb185-12" aria-hidden="true" tabindex="-1"></a>sim_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb185-13"><a href="practical-multiple-regression.html#cb185-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-14"><a href="practical-multiple-regression.html#cb185-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sim_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb185-15"><a href="practical-multiple-regression.html#cb185-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="Practicals-module_1_files/figure-html/sim-mr-1.png" width="2100" /></p>
<p>Recall that in gradient descent we want to minimise the Mean Squared Error (<span class="math inline">\(J(\beta)\)</span>) which is the cost function. The first step is to write this cost function in R. For simplicity we will use matrix multiplication, which in R is implemented as <code>%*%</code>. (<em>Note</em>, to get help on these function with special characters you can’t simply run the command <code>?%*%</code> instead you have to put it in quotes <code>?"%*%"</code>.)</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="practical-multiple-regression.html#cb186-1" aria-hidden="true" tabindex="-1"></a>cost_fn <span class="ot">&lt;-</span> <span class="cf">function</span>(X, y, coef) {</span>
<span id="cb186-2"><a href="practical-multiple-regression.html#cb186-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>( (X <span class="sc">%*%</span> coef <span class="sc">-</span> y)<span class="sc">^</span><span class="dv">2</span> ) <span class="sc">/</span> (<span class="dv">2</span><span class="sc">*</span><span class="fu">length</span>(y))</span>
<span id="cb186-3"><a href="practical-multiple-regression.html#cb186-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>To perform an optimisation we will have to initialise parameters, in general optimisation algorithms won’t always produce the same results for all choices of initialisations.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="practical-multiple-regression.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First we set alpha and the number of iterations we will perform</span></span>
<span id="cb187-2"><a href="practical-multiple-regression.html#cb187-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb187-3"><a href="practical-multiple-regression.html#cb187-3" aria-hidden="true" tabindex="-1"></a>num_iters <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb187-4"><a href="practical-multiple-regression.html#cb187-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-5"><a href="practical-multiple-regression.html#cb187-5" aria-hidden="true" tabindex="-1"></a><span class="co"># next we will initialise regression coefficients</span></span>
<span id="cb187-6"><a href="practical-multiple-regression.html#cb187-6" aria-hidden="true" tabindex="-1"></a>coef <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb187-7"><a href="practical-multiple-regression.html#cb187-7" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>, <span class="fu">matrix</span>(x))</span>
<span id="cb187-8"><a href="practical-multiple-regression.html#cb187-8" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, num_iters)</span></code></pre></div>
<p>We now write a for loop to compute the optimisation, where we store the full history of the opmtimisation.</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="practical-multiple-regression.html#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_iters) {</span>
<span id="cb188-2"><a href="practical-multiple-regression.html#cb188-2" aria-hidden="true" tabindex="-1"></a>  error <span class="ot">&lt;-</span> (X <span class="sc">%*%</span> coef <span class="sc">-</span> y)</span>
<span id="cb188-3"><a href="practical-multiple-regression.html#cb188-3" aria-hidden="true" tabindex="-1"></a>  delta <span class="ot">&lt;-</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> error <span class="sc">/</span> <span class="fu">length</span>(y)</span>
<span id="cb188-4"><a href="practical-multiple-regression.html#cb188-4" aria-hidden="true" tabindex="-1"></a>  coef <span class="ot">&lt;-</span> coef <span class="sc">-</span> alpha <span class="sc">*</span> delta</span>
<span id="cb188-5"><a href="practical-multiple-regression.html#cb188-5" aria-hidden="true" tabindex="-1"></a>  res_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">itr =</span> i , <span class="at">cost =</span> <span class="fu">cost_fn</span>(X, y, coef),</span>
<span id="cb188-6"><a href="practical-multiple-regression.html#cb188-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">b0 =</span> coef[<span class="dv">1</span>], <span class="at">b1 =</span> coef[<span class="dv">2</span>])</span>
<span id="cb188-7"><a href="practical-multiple-regression.html#cb188-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-8"><a href="practical-multiple-regression.html#cb188-8" aria-hidden="true" tabindex="-1"></a>  res[[i]] <span class="ot">&lt;-</span> res_df</span>
<span id="cb188-9"><a href="practical-multiple-regression.html#cb188-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We created a list to store results <code>res</code> it is possible to combine all results into a simple <code>data.frame</code> using the <code>bind_rows()</code> function from the <code>dplyr</code> package. If we look at the final values in the resulting variable we will</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="practical-multiple-regression.html#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb189-2"><a href="practical-multiple-regression.html#cb189-2" aria-hidden="true" tabindex="-1"></a>res_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(res)</span>
<span id="cb189-3"><a href="practical-multiple-regression.html#cb189-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(res_df)</span></code></pre></div>
<pre><code>##     itr      cost       b0       b1
## 95   95 0.5275707 2.034285 3.014512
## 96   96 0.5275707 2.034285 3.014512
## 97   97 0.5275707 2.034285 3.014512
## 98   98 0.5275707 2.034285 3.014512
## 99   99 0.5275707 2.034285 3.014512
## 100 100 0.5275707 2.034285 3.014512</code></pre>
<p>We can see that <span class="math inline">\(\beta_0 = 2\)</span> and <span class="math inline">\(\beta_1 = 3\)</span> are reproduced faithfully. There are a few ways to visualise the optimisation. We can look at the convergence of the parameters, the cost function itself or even the estimated <span class="math inline">\(y\)</span> at each step of the optimisation.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="practical-multiple-regression.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(res_df, <span class="fu">aes</span>(<span class="at">x =</span> itr, <span class="at">y =</span> b1)) <span class="sc">+</span></span>
<span id="cb191-2"><a href="practical-multiple-regression.html#cb191-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb191-3"><a href="practical-multiple-regression.html#cb191-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Iteration&quot;</span>,</span>
<span id="cb191-4"><a href="practical-multiple-regression.html#cb191-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Estimated beta_1&quot;</span>,</span>
<span id="cb191-5"><a href="practical-multiple-regression.html#cb191-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">&quot;Visuaslisation of the cconvergence of the beta_1 parameter&quot;</span>)</span></code></pre></div>
<p><img src="Practicals-module_1_files/figure-html/vis_gd-1.png" width="3000" /></p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="practical-multiple-regression.html#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(res_df, <span class="fu">aes</span>(<span class="at">x =</span> itr, <span class="at">y =</span> cost)) <span class="sc">+</span></span>
<span id="cb192-2"><a href="practical-multiple-regression.html#cb192-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb192-3"><a href="practical-multiple-regression.html#cb192-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Iteration&quot;</span>,</span>
<span id="cb192-4"><a href="practical-multiple-regression.html#cb192-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;Cost function&quot;</span>,</span>
<span id="cb192-5"><a href="practical-multiple-regression.html#cb192-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">&quot;History of cost function at each iteration&quot;</span>)</span></code></pre></div>
<p><img src="Practicals-module_1_files/figure-html/vis_gd-2.png" width="3000" /></p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="practical-multiple-regression.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sim_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb193-2"><a href="practical-multiple-regression.html#cb193-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb193-3"><a href="practical-multiple-regression.html#cb193-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">data =</span> res_df, <span class="fu">aes</span>(<span class="at">intercept =</span> b0, <span class="at">slope =</span> b1),</span>
<span id="cb193-4"><a href="practical-multiple-regression.html#cb193-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb193-5"><a href="practical-multiple-regression.html#cb193-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;x&quot;</span>, <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb193-6"><a href="practical-multiple-regression.html#cb193-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">&quot;Estimated response at each step during optimisation&quot;</span>)</span></code></pre></div>
<p><img src="Practicals-module_1_files/figure-html/vis_gd-3.png" width="3000" /></p>
<p>Now compare these results to the ones obtained by fitting a linear model in R using the function <code>lm()</code>, how different are the results. Try to reproduce these plots with <span class="math inline">\(\alpha =\)</span> (0.02, 0.1, 0.5), and different number of iterations in the optimisation and compare the estimated <span class="math inline">\(\hat{\beta}_0\)</span>, and <span class="math inline">\(\hat{\beta}_1\)</span> to the values you use during the simulation step. This will give you an idea how important the right choice of these two parameters is.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="practical-principal-component-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="practical-generalised-linear-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Practicals-module_1.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
