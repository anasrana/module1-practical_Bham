<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Model Answers: Monte Carlo | Essentials of Mathematics and Statistics</title>
  <meta name="description" content="This contains practicals for Module 1 (Essentials of Mathematics and Statistics)." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Model Answers: Monte Carlo | Essentials of Mathematics and Statistics" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://anasrana.github.io/module1-practical_Bham/" />
  
  <meta property="og:description" content="This contains practicals for Module 1 (Essentials of Mathematics and Statistics)." />
  <meta name="github-repo" content="anasrana/module1-practical_Bham" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Model Answers: Monte Carlo | Essentials of Mathematics and Statistics" />
  
  <meta name="twitter:description" content="This contains practicals for Module 1 (Essentials of Mathematics and Statistics)." />
  

<meta name="author" content="Anas A Rana" />


<meta name="date" content="2021-10-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="monte-carlo-methods.html"/>
<link rel="next" href="maximum-likelihood.html"/>
<script src="assets/header-attrs-2.11/header-attrs.js"></script>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Essentials of Mathematics and Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#how-to-use-these-resources"><i class="fa fa-check"></i><b>1.1</b> How to use these resources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started-in-r-and-rstudio.html"><a href="getting-started-in-r-and-rstudio.html"><i class="fa fa-check"></i><b>2</b> Getting started in R and Rstudio</a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started-in-r-and-rstudio.html"><a href="getting-started-in-r-and-rstudio.html#r-scripts"><i class="fa fa-check"></i><b>2.1</b> R scripts</a></li>
<li class="chapter" data-level="2.2" data-path="getting-started-in-r-and-rstudio.html"><a href="getting-started-in-r-and-rstudio.html#creating-an-r-script"><i class="fa fa-check"></i><b>2.2</b> Creating an R script</a></li>
<li class="chapter" data-level="2.3" data-path="getting-started-in-r-and-rstudio.html"><a href="getting-started-in-r-and-rstudio.html#saving-an-r-script"><i class="fa fa-check"></i><b>2.3</b> Saving an R script</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started-in-r-and-rstudio.html"><a href="getting-started-in-r-and-rstudio.html#executing-code-in-an-r-script"><i class="fa fa-check"></i><b>2.4</b> Executing code in an R script</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="getting-started-in-r-and-rstudio.html"><a href="getting-started-in-r-and-rstudio.html#comments-in-an-r-script-documenting-your-code"><i class="fa fa-check"></i><b>2.4.1</b> Comments in an R script (documenting your code)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-sets.html"><a href="data-sets.html"><i class="fa fa-check"></i><b>3</b> Data sets</a></li>
<li class="chapter" data-level="4" data-path="simulating-random-numbers.html"><a href="simulating-random-numbers.html"><i class="fa fa-check"></i><b>4</b> Simulating random numbers</a></li>
<li class="chapter" data-level="5" data-path="markov-chains.html"><a href="markov-chains.html"><i class="fa fa-check"></i><b>5</b> Markov Chains</a></li>
<li class="chapter" data-level="" data-path="model-answers-3-state-markov-chain.html"><a href="model-answers-3-state-markov-chain.html"><i class="fa fa-check"></i>Model answers 3 state Markov Chain</a></li>
<li class="chapter" data-level="6" data-path="a-monopoly-simulation.html"><a href="a-monopoly-simulation.html"><i class="fa fa-check"></i><b>6</b> A Monopoly simulation</a>
<ul>
<li class="chapter" data-level="6.1" data-path="a-monopoly-simulation.html"><a href="a-monopoly-simulation.html#moving-around-the-board"><i class="fa fa-check"></i><b>6.1</b> Moving around the board</a></li>
<li class="chapter" data-level="6.2" data-path="a-monopoly-simulation.html"><a href="a-monopoly-simulation.html#going-to-jail"><i class="fa fa-check"></i><b>6.2</b> Going to Jail</a></li>
<li class="chapter" data-level="6.3" data-path="a-monopoly-simulation.html"><a href="a-monopoly-simulation.html#further-exercises"><i class="fa fa-check"></i><b>6.3</b> Further Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html"><i class="fa fa-check"></i><b>7</b> Monte Carlo Methods</a>
<ul>
<li class="chapter" data-level="7.1" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#integration"><i class="fa fa-check"></i><b>7.1</b> Integration</a></li>
<li class="chapter" data-level="7.2" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#problem-mc-accuracy"><i class="fa fa-check"></i><b>7.2</b> Problem: MC accuracy</a></li>
<li class="chapter" data-level="7.3" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#approximating-the-binomial-distribution"><i class="fa fa-check"></i><b>7.3</b> Approximating the Binomial Distribution</a></li>
<li class="chapter" data-level="7.4" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#problem-mc-binomial"><i class="fa fa-check"></i><b>7.4</b> Problem: MC Binomial</a></li>
<li class="chapter" data-level="7.5" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#monte-carlo-expectations"><i class="fa fa-check"></i><b>7.5</b> Monte Carlo Expectations</a></li>
<li class="chapter" data-level="7.6" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#using-functions"><i class="fa fa-check"></i><b>7.6</b> Using Functions</a></li>
<li class="chapter" data-level="7.7" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#simulating-from-function"><i class="fa fa-check"></i><b>7.7</b> Simulating from function</a></li>
<li class="chapter" data-level="7.8" data-path="monte-carlo-methods.html"><a href="monte-carlo-methods.html#problem-mc-expectation"><i class="fa fa-check"></i><b>7.8</b> Problem: MC Expectation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-answers-monte-carlo.html"><a href="model-answers-monte-carlo.html"><i class="fa fa-check"></i>Model Answers: Monte Carlo</a>
<ul>
<li class="chapter" data-level="7.9" data-path="model-answers-monte-carlo.html"><a href="model-answers-monte-carlo.html#problem-mc-accuracy-1"><i class="fa fa-check"></i><b>7.9</b> Problem: MC accuracy</a></li>
<li class="chapter" data-level="7.10" data-path="model-answers-monte-carlo.html"><a href="model-answers-monte-carlo.html#problem-mc-expectation-1"><i class="fa fa-check"></i><b>7.10</b> Problem: MC Expectation</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="model-answers-monte-carlo.html"><a href="model-answers-monte-carlo.html#problem-1"><i class="fa fa-check"></i><b>7.10.1</b> Problem 1</a></li>
<li class="chapter" data-level="7.10.2" data-path="model-answers-monte-carlo.html"><a href="model-answers-monte-carlo.html#problem-2"><i class="fa fa-check"></i><b>7.10.2</b> Problem 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html"><i class="fa fa-check"></i><b>8</b> Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="8.1" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#the-likelihood-function"><i class="fa fa-check"></i><b>8.1</b> The likelihood function</a></li>
<li class="chapter" data-level="8.2" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#optimisation"><i class="fa fa-check"></i><b>8.2</b> Optimisation</a></li>
<li class="chapter" data-level="8.3" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#two-parameter-estimation"><i class="fa fa-check"></i><b>8.3</b> Two-parameter estimation</a></li>
<li class="chapter" data-level="8.4" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#problem-mle"><i class="fa fa-check"></i><b>8.4</b> Problem: MLE</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-answers-mle.html"><a href="model-answers-mle.html"><i class="fa fa-check"></i>Model Answers: MLE</a></li>
<li class="chapter" data-level="9" data-path="confidence-intervals.html"><a href="confidence-intervals.html"><i class="fa fa-check"></i><b>9</b> Confidence Intervals</a>
<ul>
<li class="chapter" data-level="9.1" data-path="confidence-intervals.html"><a href="confidence-intervals.html#setup"><i class="fa fa-check"></i><b>9.1</b> Setup</a></li>
<li class="chapter" data-level="9.2" data-path="confidence-intervals.html"><a href="confidence-intervals.html#simulating-data"><i class="fa fa-check"></i><b>9.2</b> Simulating data</a></li>
<li class="chapter" data-level="9.3" data-path="confidence-intervals.html"><a href="confidence-intervals.html#constructing-the-confidence-interval"><i class="fa fa-check"></i><b>9.3</b> Constructing the confidence interval</a></li>
<li class="chapter" data-level="9.4" data-path="confidence-intervals.html"><a href="confidence-intervals.html#experiment"><i class="fa fa-check"></i><b>9.4</b> Experiment</a></li>
<li class="chapter" data-level="9.5" data-path="confidence-intervals.html"><a href="confidence-intervals.html#problem-confidence-interval"><i class="fa fa-check"></i><b>9.5</b> Problem: Confidence Interval</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-answer-confidence-interval.html"><a href="model-answer-confidence-interval.html"><i class="fa fa-check"></i>Model Answer: Confidence Interval</a></li>
<li class="chapter" data-level="10" data-path="computational-testing-techniques.html"><a href="computational-testing-techniques.html"><i class="fa fa-check"></i><b>10</b> Computational Testing Techniques</a>
<ul>
<li class="chapter" data-level="10.1" data-path="computational-testing-techniques.html"><a href="computational-testing-techniques.html#problem-1-1"><i class="fa fa-check"></i><b>10.1</b> Problem 1</a></li>
<li class="chapter" data-level="10.2" data-path="computational-testing-techniques.html"><a href="computational-testing-techniques.html#problem-2-1"><i class="fa fa-check"></i><b>10.2</b> Problem 2</a></li>
<li class="chapter" data-level="10.3" data-path="computational-testing-techniques.html"><a href="computational-testing-techniques.html#problem-3"><i class="fa fa-check"></i><b>10.3</b> Problem 3</a></li>
<li class="chapter" data-level="10.4" data-path="computational-testing-techniques.html"><a href="computational-testing-techniques.html#problem-4"><i class="fa fa-check"></i><b>10.4</b> Problem 4</a></li>
<li class="chapter" data-level="10.5" data-path="computational-testing-techniques.html"><a href="computational-testing-techniques.html#problem-5"><i class="fa fa-check"></i><b>10.5</b> Problem 5</a></li>
<li class="chapter" data-level="10.6" data-path="computational-testing-techniques.html"><a href="computational-testing-techniques.html#problem-7"><i class="fa fa-check"></i><b>10.6</b> Problem 7</a></li>
<li class="chapter" data-level="10.7" data-path="computational-testing-techniques.html"><a href="computational-testing-techniques.html#problem-8"><i class="fa fa-check"></i><b>10.7</b> Problem 8</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-answers-computational-testing.html"><a href="model-answers-computational-testing.html"><i class="fa fa-check"></i>Model Answers: Computational Testing</a>
<ul>
<li class="chapter" data-level="10.8" data-path="model-answers-computational-testing.html"><a href="model-answers-computational-testing.html#problem-1-2"><i class="fa fa-check"></i><b>10.8</b> Problem 1</a></li>
<li class="chapter" data-level="10.9" data-path="model-answers-computational-testing.html"><a href="model-answers-computational-testing.html#problem-2-2"><i class="fa fa-check"></i><b>10.9</b> Problem 2</a></li>
<li class="chapter" data-level="10.10" data-path="model-answers-computational-testing.html"><a href="model-answers-computational-testing.html#problem-3-1"><i class="fa fa-check"></i><b>10.10</b> Problem 3</a></li>
<li class="chapter" data-level="10.11" data-path="model-answers-computational-testing.html"><a href="model-answers-computational-testing.html#problem-4-1"><i class="fa fa-check"></i><b>10.11</b> Problem 4</a></li>
<li class="chapter" data-level="10.12" data-path="model-answers-computational-testing.html"><a href="model-answers-computational-testing.html#problem-5-1"><i class="fa fa-check"></i><b>10.12</b> Problem 5</a></li>
<li class="chapter" data-level="10.13" data-path="model-answers-computational-testing.html"><a href="model-answers-computational-testing.html#problem-6"><i class="fa fa-check"></i><b>10.13</b> Problem 6</a></li>
<li class="chapter" data-level="10.14" data-path="model-answers-computational-testing.html"><a href="model-answers-computational-testing.html#problem-7-1"><i class="fa fa-check"></i><b>10.14</b> Problem 7</a></li>
<li class="chapter" data-level="10.15" data-path="model-answers-computational-testing.html"><a href="model-answers-computational-testing.html#problem-8-1"><i class="fa fa-check"></i><b>10.15</b> Problem 8</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html"><i class="fa fa-check"></i><b>11</b> Practical: Linear regression</a>
<ul>
<li class="chapter" data-level="11.1" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#data"><i class="fa fa-check"></i><b>11.1</b> Data</a></li>
<li class="chapter" data-level="11.2" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#simulating-data-1"><i class="fa fa-check"></i><b>11.2</b> Simulating data</a></li>
<li class="chapter" data-level="11.3" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#fitting-simple-linear-regression-model"><i class="fa fa-check"></i><b>11.3</b> Fitting simple linear regression model</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#least-squared-estimation"><i class="fa fa-check"></i><b>11.3.1</b> Least squared estimation</a></li>
<li class="chapter" data-level="11.3.2" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#maximum-likelihood-estimation"><i class="fa fa-check"></i><b>11.3.2</b> Maximum likelihood estimation</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#effect-of-variance"><i class="fa fa-check"></i><b>11.4</b> Effect of variance</a></li>
<li class="chapter" data-level="11.5" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#exercise"><i class="fa fa-check"></i><b>11.5</b> Exercise</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#part-i"><i class="fa fa-check"></i><b>11.5.1</b> Part I</a></li>
<li class="chapter" data-level="11.5.2" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#part-ii"><i class="fa fa-check"></i><b>11.5.2</b> Part II</a></li>
<li class="chapter" data-level="11.5.3" data-path="practical-linear-regression.html"><a href="practical-linear-regression.html#part-iii"><i class="fa fa-check"></i><b>11.5.3</b> Part III</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-answers-linear-regression.html"><a href="model-answers-linear-regression.html"><i class="fa fa-check"></i>Model answers: Linear regression</a>
<ul>
<li class="chapter" data-level="11.6" data-path="model-answers-linear-regression.html"><a href="model-answers-linear-regression.html#exercise-i"><i class="fa fa-check"></i><b>11.6</b> Exercise I</a></li>
<li class="chapter" data-level="11.7" data-path="model-answers-linear-regression.html"><a href="model-answers-linear-regression.html#exercise-ii"><i class="fa fa-check"></i><b>11.7</b> Exercise II</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="model-answers-linear-regression.html"><a href="model-answers-linear-regression.html#comparison-of-data"><i class="fa fa-check"></i><b>11.7.1</b> Comparison of data</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="model-answers-linear-regression.html"><a href="model-answers-linear-regression.html#exercise-ii-1"><i class="fa fa-check"></i><b>11.8</b> Exercise II</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="practical-principal-component-analysis.html"><a href="practical-principal-component-analysis.html"><i class="fa fa-check"></i><b>12</b> Practical: Principal component analysis</a>
<ul>
<li class="chapter" data-level="12.1" data-path="practical-principal-component-analysis.html"><a href="practical-principal-component-analysis.html#data-1"><i class="fa fa-check"></i><b>12.1</b> Data</a></li>
<li class="chapter" data-level="12.2" data-path="practical-principal-component-analysis.html"><a href="practical-principal-component-analysis.html#introduction-1"><i class="fa fa-check"></i><b>12.2</b> Introduction</a></li>
<li class="chapter" data-level="12.3" data-path="practical-principal-component-analysis.html"><a href="practical-principal-component-analysis.html#exercise-i-1"><i class="fa fa-check"></i><b>12.3</b> Exercise I</a></li>
<li class="chapter" data-level="12.4" data-path="practical-principal-component-analysis.html"><a href="practical-principal-component-analysis.html#exercise-ii-2"><i class="fa fa-check"></i><b>12.4</b> Exercise II</a></li>
<li class="chapter" data-level="12.5" data-path="practical-principal-component-analysis.html"><a href="practical-principal-component-analysis.html#exercise-iii"><i class="fa fa-check"></i><b>12.5</b> Exercise III</a></li>
<li class="chapter" data-level="12.6" data-path="practical-principal-component-analysis.html"><a href="practical-principal-component-analysis.html#exercise-iv-single-cell-data"><i class="fa fa-check"></i><b>12.6</b> Exercise IV: Single cell data</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="practical-multiple-regression.html"><a href="practical-multiple-regression.html"><i class="fa fa-check"></i><b>13</b> Practical: Multiple regression</a>
<ul>
<li class="chapter" data-level="13.1" data-path="practical-multiple-regression.html"><a href="practical-multiple-regression.html#multiple-regression"><i class="fa fa-check"></i><b>13.1</b> Multiple regression</a></li>
<li class="chapter" data-level="13.2" data-path="practical-multiple-regression.html"><a href="practical-multiple-regression.html#categorical-covariates"><i class="fa fa-check"></i><b>13.2</b> Categorical covariates</a></li>
<li class="chapter" data-level="13.3" data-path="practical-multiple-regression.html"><a href="practical-multiple-regression.html#residuals"><i class="fa fa-check"></i><b>13.3</b> Residuals</a></li>
<li class="chapter" data-level="13.4" data-path="practical-multiple-regression.html"><a href="practical-multiple-regression.html#gradient-descent-algorithm"><i class="fa fa-check"></i><b>13.4</b> Gradient descent algorithm (+)</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html"><i class="fa fa-check"></i><b>14</b> Practical: Generalised linear models</a>
<ul>
<li class="chapter" data-level="14.1" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#data-2"><i class="fa fa-check"></i><b>14.1</b> Data</a></li>
<li class="chapter" data-level="14.2" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#detecting-snp-associations"><i class="fa fa-check"></i><b>14.2</b> Detecting SNP associations</a></li>
<li class="chapter" data-level="14.3" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#gwas-and-logistic-regression"><i class="fa fa-check"></i><b>14.3</b> GWAS and logistic regression</a></li>
<li class="chapter" data-level="14.4" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#negative-binomial-and-poisson-regression"><i class="fa fa-check"></i><b>14.4</b> Negative binomial and Poisson regression</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#count-based-glms"><i class="fa fa-check"></i><b>14.4.1</b> Count-based GLMs</a></li>
<li class="chapter" data-level="14.4.2" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#fitting-a-glm"><i class="fa fa-check"></i><b>14.4.2</b> Fitting a GLM</a></li>
<li class="chapter" data-level="14.4.3" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#comparing-nested-models"><i class="fa fa-check"></i><b>14.4.3</b> Comparing nested models</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#negative-binomial-vs-poisson-glms"><i class="fa fa-check"></i><b>14.5</b> Negative-Binomial vs Poisson GLMs</a></li>
<li class="chapter" data-level="14.6" data-path="practical-generalised-linear-models.html"><a href="practical-generalised-linear-models.html#further-understanding-the-model-optional"><i class="fa fa-check"></i><b>14.6</b> Further understanding the model (<strong>OPTIONAL</strong>)</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Essentials of Mathematics and Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="model-answers-monte-carlo" class="section level1 unnumbered">
<h1>Model Answers: Monte Carlo</h1>
<div id="problem-mc-accuracy-1" class="section level2" number="7.9">
<h2><span class="header-section-number">7.9</span> Problem: MC accuracy</h2>
<p>First let’s increase the number of simulations and out the accuracy</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="model-answers-monte-carlo.html#cb40-1" aria-hidden="true" tabindex="-1"></a>sample_sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">250</span>, <span class="dv">500</span>, <span class="dv">1000</span>) <span class="co"># try different sample sizes</span></span>
<span id="cb40-2"><a href="model-answers-monte-carlo.html#cb40-2" aria-hidden="true" tabindex="-1"></a>n_sample_sizes <span class="ot">&lt;-</span> <span class="fu">length</span>(sample_sizes) <span class="co"># number of sample sizes to try</span></span>
<span id="cb40-3"><a href="model-answers-monte-carlo.html#cb40-3" aria-hidden="true" tabindex="-1"></a>rpts <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># number of repeats for each sample size</span></span>
<span id="cb40-4"><a href="model-answers-monte-carlo.html#cb40-4" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n_sample_sizes) <span class="co"># vector to record accuracy values</span></span>
<span id="cb40-5"><a href="model-answers-monte-carlo.html#cb40-5" aria-hidden="true" tabindex="-1"></a>accuracy_sd <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n_sample_sizes) <span class="co"># vector to record accuracy sd values</span></span>
<span id="cb40-6"><a href="model-answers-monte-carlo.html#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="model-answers-monte-carlo.html#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co"># for each sample size</span></span>
<span id="cb40-8"><a href="model-answers-monte-carlo.html#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_sample_sizes) {</span>
<span id="cb40-9"><a href="model-answers-monte-carlo.html#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="model-answers-monte-carlo.html#cb40-10" aria-hidden="true" tabindex="-1"></a>  sample_sz <span class="ot">&lt;-</span> sample_sizes[i] <span class="co"># select a sanmple size to use</span></span>
<span id="cb40-11"><a href="model-answers-monte-carlo.html#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="model-answers-monte-carlo.html#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># vector to store results from each repeat</span></span>
<span id="cb40-13"><a href="model-answers-monte-carlo.html#cb40-13" aria-hidden="true" tabindex="-1"></a>  mc_integral <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, rpts)</span>
<span id="cb40-14"><a href="model-answers-monte-carlo.html#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rpts){</span>
<span id="cb40-15"><a href="model-answers-monte-carlo.html#cb40-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># simulated normally distributed numbers</span></span>
<span id="cb40-16"><a href="model-answers-monte-carlo.html#cb40-16" aria-hidden="true" tabindex="-1"></a>    sims <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(sample_sz, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb40-17"><a href="model-answers-monte-carlo.html#cb40-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># find proportion of values between 1-3</span></span>
<span id="cb40-18"><a href="model-answers-monte-carlo.html#cb40-18" aria-hidden="true" tabindex="-1"></a>    mc_integral[j] <span class="ot">&lt;-</span> <span class="fu">sum</span>(sims <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> sims <span class="sc">&lt;=</span> <span class="dv">3</span>) <span class="sc">/</span> sample_sz</span>
<span id="cb40-19"><a href="model-answers-monte-carlo.html#cb40-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-20"><a href="model-answers-monte-carlo.html#cb40-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-21"><a href="model-answers-monte-carlo.html#cb40-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compute average difference between integral estimate and real value</span></span>
<span id="cb40-22"><a href="model-answers-monte-carlo.html#cb40-22" aria-hidden="true" tabindex="-1"></a>  accuracy[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(mc_integral <span class="sc">-</span> mc_exact)</span>
<span id="cb40-23"><a href="model-answers-monte-carlo.html#cb40-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compute sd difference between integral estimate and real value</span></span>
<span id="cb40-24"><a href="model-answers-monte-carlo.html#cb40-24" aria-hidden="true" tabindex="-1"></a>  accuracy_sd[i] <span class="ot">&lt;-</span> <span class="fu">sd</span>(mc_integral <span class="sc">-</span> mc_exact)</span>
<span id="cb40-25"><a href="model-answers-monte-carlo.html#cb40-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-26"><a href="model-answers-monte-carlo.html#cb40-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-27"><a href="model-answers-monte-carlo.html#cb40-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-28"><a href="model-answers-monte-carlo.html#cb40-28" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(accuracy)</span></code></pre></div>
<pre><code>## [1]  0.0106552539  0.0036552539 -0.0039447461  0.0032152539 -0.0031647461 -0.0006047461</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="model-answers-monte-carlo.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(accuracy_sd)</span></code></pre></div>
<pre><code>## [1] 0.13594414 0.06632488 0.04777092 0.02988473 0.02036256 0.01492582</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="model-answers-monte-carlo.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(accuracy <span class="sc">+</span> accuracy_sd)</span></code></pre></div>
<pre><code>## [1] 0.14659939 0.06998014 0.04382617 0.03309999 0.01719782 0.01432108</code></pre>
<p>Next, we will plot the results. Here we will make use of <code>ggplot2</code> a library to create nice plots without much effort. The input need to be a <code>data.frame</code> so we will need to create one based on the data.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="model-answers-monte-carlo.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load ggplot</span></span>
<span id="cb46-2"><a href="model-answers-monte-carlo.html#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb46-3"><a href="model-answers-monte-carlo.html#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="model-answers-monte-carlo.html#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create a data frame for plotting</span></span>
<span id="cb46-5"><a href="model-answers-monte-carlo.html#cb46-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(sample_sizes, accuracy, accuracy_sd)</span>
<span id="cb46-6"><a href="model-answers-monte-carlo.html#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="model-answers-monte-carlo.html#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df)</span></code></pre></div>
<pre><code>##   sample_sizes      accuracy accuracy_sd
## 1           10  0.0106552539  0.13594414
## 2           50  0.0036552539  0.06632488
## 3          100 -0.0039447461  0.04777092
## 4          250  0.0032152539  0.02988473
## 5          500 -0.0031647461  0.02036256
## 6         1000 -0.0006047461  0.01492582</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="model-answers-monte-carlo.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use ggplot to plot lines for the mean accuracy and error bars</span></span>
<span id="cb48-2"><a href="model-answers-monte-carlo.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co"># using the std dev</span></span>
<span id="cb48-3"><a href="model-answers-monte-carlo.html#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> sample_sizes, <span class="at">y =</span> accuracy)) <span class="sc">+</span></span>
<span id="cb48-4"><a href="model-answers-monte-carlo.html#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb48-5"><a href="model-answers-monte-carlo.html#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb48-6"><a href="model-answers-monte-carlo.html#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(</span>
<span id="cb48-7"><a href="model-answers-monte-carlo.html#cb48-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">ymin =</span> accuracy <span class="sc">-</span> accuracy_sd, <span class="at">ymax =</span> accuracy <span class="sc">+</span> accuracy_sd),</span>
<span id="cb48-8"><a href="model-answers-monte-carlo.html#cb48-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">width =</span> .<span class="dv">2</span>,</span>
<span id="cb48-9"><a href="model-answers-monte-carlo.html#cb48-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb48-10"><a href="model-answers-monte-carlo.html#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Estimate-Exact&quot;</span>) <span class="sc">+</span></span>
<span id="cb48-11"><a href="model-answers-monte-carlo.html#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Run&quot;</span>)</span></code></pre></div>
<p><img src="Practicals-module_1_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<p>This shows that as the number of Monte Carlo samples is increased, the accuracy increases (i.e. the difference between the estimated integral value and real values converges to zero). In addition, the variability in the integral estimates across different simulation runs reduces.</p>
</div>
<div id="problem-mc-expectation-1" class="section level2" number="7.10">
<h2><span class="header-section-number">7.10</span> Problem: MC Expectation</h2>
<div id="problem-1" class="section level3" number="7.10.1">
<h3><span class="header-section-number">7.10.1</span> Problem 1</h3>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="model-answers-monte-carlo.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulates a game of 20 spins</span></span>
<span id="cb49-2"><a href="model-answers-monte-carlo.html#cb49-2" aria-hidden="true" tabindex="-1"></a>play_game <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb49-3"><a href="model-answers-monte-carlo.html#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># picks a number from the list (1, -1, 2)</span></span>
<span id="cb49-4"><a href="model-answers-monte-carlo.html#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">#  with probability 50%, 25% and 25% twenty times</span></span>
<span id="cb49-5"><a href="model-answers-monte-carlo.html#cb49-5" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>), <span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>))</span>
<span id="cb49-6"><a href="model-answers-monte-carlo.html#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(results)) <span class="co"># function returns the sum of all the spins</span></span>
<span id="cb49-7"><a href="model-answers-monte-carlo.html#cb49-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-8"><a href="model-answers-monte-carlo.html#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="model-answers-monte-carlo.html#cb49-9" aria-hidden="true" tabindex="-1"></a>score_per_game <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>, runs) <span class="co"># vector to store outcome of each game</span></span>
<span id="cb49-10"><a href="model-answers-monte-carlo.html#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (it <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>runs) {</span>
<span id="cb49-11"><a href="model-answers-monte-carlo.html#cb49-11" aria-hidden="true" tabindex="-1"></a>  score_per_game[it] <span class="ot">&lt;-</span> <span class="fu">play_game</span>() <span class="co"># play the game by calling the function</span></span>
<span id="cb49-12"><a href="model-answers-monte-carlo.html#cb49-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-13"><a href="model-answers-monte-carlo.html#cb49-13" aria-hidden="true" tabindex="-1"></a>expected_score <span class="ot">=</span> <span class="fu">mean</span>(score_per_game) <span class="co"># average over all simulations</span></span>
<span id="cb49-14"><a href="model-answers-monte-carlo.html#cb49-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-15"><a href="model-answers-monte-carlo.html#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(expected_score)</span></code></pre></div>
<pre><code>## [1] 14.84</code></pre>
</div>
<div id="problem-2" class="section level3" number="7.10.2">
<h3><span class="header-section-number">7.10.2</span> Problem 2</h3>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="model-answers-monte-carlo.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulates a game of up to 20 spins</span></span>
<span id="cb51-2"><a href="model-answers-monte-carlo.html#cb51-2" aria-hidden="true" tabindex="-1"></a>play_game <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb51-3"><a href="model-answers-monte-carlo.html#cb51-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># picks a number from the list (1, -1, 2)</span></span>
<span id="cb51-4"><a href="model-answers-monte-carlo.html#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">#  with probability 50%, 25% and 25% twenty times</span></span>
<span id="cb51-5"><a href="model-answers-monte-carlo.html#cb51-5" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>), <span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>))</span>
<span id="cb51-6"><a href="model-answers-monte-carlo.html#cb51-6" aria-hidden="true" tabindex="-1"></a>  results_sum <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(results) <span class="co"># compute a running sum of points</span></span>
<span id="cb51-7"><a href="model-answers-monte-carlo.html#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># check if the game goes to zero at any point</span></span>
<span id="cb51-8"><a href="model-answers-monte-carlo.html#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(results_sum <span class="sc">&lt;=</span> <span class="dv">0</span>)) {</span>
<span id="cb51-9"><a href="model-answers-monte-carlo.html#cb51-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>) <span class="co"># return zero</span></span>
<span id="cb51-10"><a href="model-answers-monte-carlo.html#cb51-10" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb51-11"><a href="model-answers-monte-carlo.html#cb51-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(results_sum[<span class="dv">20</span>]) <span class="co"># returns the final score</span></span>
<span id="cb51-12"><a href="model-answers-monte-carlo.html#cb51-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-13"><a href="model-answers-monte-carlo.html#cb51-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-14"><a href="model-answers-monte-carlo.html#cb51-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-15"><a href="model-answers-monte-carlo.html#cb51-15" aria-hidden="true" tabindex="-1"></a>game_score <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, runs) <span class="co"># vector to store scores in each game played</span></span>
<span id="cb51-16"><a href="model-answers-monte-carlo.html#cb51-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-17"><a href="model-answers-monte-carlo.html#cb51-17" aria-hidden="true" tabindex="-1"></a><span class="co"># for each game</span></span>
<span id="cb51-18"><a href="model-answers-monte-carlo.html#cb51-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (it <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>runs) {</span>
<span id="cb51-19"><a href="model-answers-monte-carlo.html#cb51-19" aria-hidden="true" tabindex="-1"></a>  game_score[it] <span class="ot">&lt;-</span> <span class="fu">play_game</span>()</span>
<span id="cb51-20"><a href="model-answers-monte-carlo.html#cb51-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-21"><a href="model-answers-monte-carlo.html#cb51-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-22"><a href="model-answers-monte-carlo.html#cb51-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(game_score))</span></code></pre></div>
<pre><code>## [1] 8.6</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="model-answers-monte-carlo.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(game_score)</span></code></pre></div>
<p><img src="Practicals-module_1_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<p>The games with score zero now corresponds to the number of games where we went bust (or genuinely ended the game with zero).</p>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="monte-carlo-methods.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="maximum-likelihood.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Practicals-module_1.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
